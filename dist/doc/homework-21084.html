<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Han Wang" />

<meta name="date" content="2021-12-19" />

<title>Homework-21084</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Homework-21084</h1>
<h4 class="author">Han Wang</h4>
<h4 class="date">2021-12-19</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<div id="section" class="section level1">
<h1>2021-09-16</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use <strong>knitr</strong> to produce at least 3 examples (texts, figures, tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="texts" class="section level3">
<h3>Texts</h3>
<p>Dataset <strong>mtcars</strong> is a data frame extracted from the 1974 <em>Motor Trend</em> US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models). <em>Mpg</em> is miles/(US) gallon, <em>cyl</em> is the number of cylinders, <em>disp</em> is displacement (cu.in.), <em>hp</em> means gross horsepower, <em>drat</em> is rear axle ratio, <em>wt</em> is weight (1000 lbs), <em>qsec</em> represents 1/4 mile time, <em>vs</em> is engine (0 = V-shaped, 1 = straight), <em>am</em> is transmission (0 = automatic, 1 = manual), <em>gear</em> is the number of forward gears and <em>carb</em> is the number of carburetors.</p>
</div>
<div id="tables" class="section level3">
<h3>Tables</h3>
<p>We randomly select 12 data from the Dataset to create a table with 12 rows and 12 columns.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mtcars[<span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars),<span class="dv">12</span>)),])</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258.0</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225.0</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Merc 230</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">140.8</td>
<td align="right">95</td>
<td align="right">3.92</td>
<td align="right">3.150</td>
<td align="right">22.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Merc 450SE</td>
<td align="right">16.4</td>
<td align="right">8</td>
<td align="right">275.8</td>
<td align="right">180</td>
<td align="right">3.07</td>
<td align="right">4.070</td>
<td align="right">17.40</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Cadillac Fleetwood</td>
<td align="right">10.4</td>
<td align="right">8</td>
<td align="right">472.0</td>
<td align="right">205</td>
<td align="right">2.93</td>
<td align="right">5.250</td>
<td align="right">17.98</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Lincoln Continental</td>
<td align="right">10.4</td>
<td align="right">8</td>
<td align="right">460.0</td>
<td align="right">215</td>
<td align="right">3.00</td>
<td align="right">5.424</td>
<td align="right">17.82</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Dodge Challenger</td>
<td align="right">15.5</td>
<td align="right">8</td>
<td align="right">318.0</td>
<td align="right">150</td>
<td align="right">2.76</td>
<td align="right">3.520</td>
<td align="right">16.87</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Fiat X1-9</td>
<td align="right">27.3</td>
<td align="right">4</td>
<td align="right">79.0</td>
<td align="right">66</td>
<td align="right">4.08</td>
<td align="right">1.935</td>
<td align="right">18.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Lotus Europa</td>
<td align="right">30.4</td>
<td align="right">4</td>
<td align="right">95.1</td>
<td align="right">113</td>
<td align="right">3.77</td>
<td align="right">1.513</td>
<td align="right">16.90</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Maserati Bora</td>
<td align="right">15.0</td>
<td align="right">8</td>
<td align="right">301.0</td>
<td align="right">335</td>
<td align="right">3.54</td>
<td align="right">3.570</td>
<td align="right">14.60</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">Volvo 142E</td>
<td align="right">21.4</td>
<td align="right">4</td>
<td align="right">121.0</td>
<td align="right">109</td>
<td align="right">4.11</td>
<td align="right">2.780</td>
<td align="right">18.60</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
<div id="figures" class="section level3">
<h3>Figures</h3>
<p>Plot <em>mpg</em>, <em>disp</em>, <em>hp</em> and <em>drat</em> against <em>wt</em> and their fitting lines respectively.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mtcars<span class="sc">$</span>wt,mtcars<span class="sc">$</span>mpg,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">xlab =</span> <span class="st">&quot;wt&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;mpg&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(mtcars<span class="sc">$</span>mpg<span class="sc">~</span>mtcars<span class="sc">$</span>wt),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mtcars<span class="sc">$</span>wt,mtcars<span class="sc">$</span>disp,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">xlab =</span> <span class="st">&quot;wt&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;disp&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(mtcars<span class="sc">$</span>disp<span class="sc">~</span>mtcars<span class="sc">$</span>wt),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kLY6kNtmAABmADpmZgBmZmZmtv+QOgCQZgCQtpCQ2/+2ZgC2kDq2///bkDrb2//b/7bb////AAD/tmb/25D//7b//9v///8GHNF2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIXUlEQVR4nO2dC5ecJhiGTbubpOlO2ky7NrbLXPz/P7KKjlfg/VTAy7zPOclxGgb0KXyAIpPkxEmy9glsHQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBPAsKNkFqvizliC/2fmklaLyCSf6NIJ01SkPlNIfxd/zfBp+s/NH3biq6pNT0IhH9HmEHwoaUPtpWhoFDen4KQ1R0IikjM4UZKfqvCjIxqP3YgwyUg1+8kf9oaABg+qTU1AP1fVTG6KgFvU4oCAjjR8KMqFU5wNj0AjV/9je8qCgEqWs/0RB+aj69KAgt58jCxLeT3Y0L52LuDhpwlWyM5WQiAy59RxYUHcs4wD5iS2ofaLiJTtckjsRaF46H3GB0oSrZGcoQCAI6zmwIByDBNUnP7Ig1IuJ9BxakBuhn2cVJGteJc8pSKznUIKqhxCCAYS8+uRHEiQeYk3Rs39B7Y2tRGhomp+9C+rcGh0JMpqa1Lx0Lt4TxsyuI2QkyFiXpuo5kKBhDDK2tul+DiRo0IsZBE1uXjof7wk193N1fr/89JKdFXtMHguaoyeUoCx5qw4uj4NF2Tmw91kDP7OqTx5I0P3caMlePhZnN5O+n9m5eE9YcDv9eBxeLI0s8lRjtp+D1SBLg5vbvHSWMxLeTsWJWC68IkvqKhQ8BvUzNYfsBXpmCbp8ei/+zvTfNrRDl8YQgswTjSXVJ58j6H6uakfqrEPeyp2Sp6exYT/TyQlv36uqYwu/nsuV52icqi71s6AG2cJvnSjOQLGToWkyv7B56XynJ7zoCNzEYRPxBopNfuPZvIfqk89qYqf2TCwVZIVu3iTIh5/YA0VTO/DCWJCH5qUz9p4wX2egWJnp+PGV7/SEt9NbEWScI8U1BoqVmaT7MpyXbKcnLAZA18+vefrqSL3KQLFF9RrxogY9J0j/0B3Z1sZBHVQvzC0LefMEpYWcbKuClOoF64Wdwpwm9no7vXzcTq4mprkkiXXCFk6QGoyp4wsq4sun9/vZ6SdNkrfrt49uhz+zXHxi/fuqKl9dkIByIptWk/7Q3Xz/6rsvM60VgwToenP9UgoKfUfRPHbuO4nciwkoR0rFcPHfPHwNCjB2HhQwLWFx6c1czNGLNT1cpWpJuei0WkEh9AR7Llbfb7xYp/z+Y1AYPzt/sqpz0n6CNC+d/bSEgnsdnsuVEUrPzBtmZVy5OG/a+ytXQrDqk8+75VoNEZ23XP2VK6B9Fddjpg/mzcVKNjNZHb/K7ZM5NajquTfy2Mf0KrdP5t+030YMMr7K7ZMwj549luukE523JChquS56nddmYlDkch1YX+X2yX4FhRz8dNitoDh6ogtqJyoLM4rlZ6c1KFLzKtmloHh6dikoYvXJ9ygoqp4dCorsZ2+CXM2LA0Wwj82zTzWSRLnujD39ZFXvn14fmUQ8u6Bqf/kkt5p4dkH1mpbxaujm8LljULPkZyioc/zMvVh3TcvYT9DNiAIJ8rrSXj12eB41ME+3BlyEEeR1pX1n8DOOP/sU5HOdtHLceI7gJ/ZK+8nZDcfOPR0R/Gy1Bj0uW3U/DI+Dde29M/GesGTpSvv6wpvobF1vGNxPqF5s2Ur7uumMV2TGaFPDc/Ge0EN2lR7V69rbf6Cg6sdRusOe4wlaOFC0+IkSlYen4j1hiXCgaL1YpeqdXJK6kbXfi+xn1W7eWh0CL/mZROSBYrfNWK+/v+ZnQrkhWLEGWQSp/txrQrFBWHGgaBDUDH62w5oDxVEI1r+c1xyvXnk0q46DmnFg/SFp3zXdQvjRrD1Q7IVs1bO1DUNbEZTUP0xJQYPsWkGqK+XgggSvvPRvm3ZeVe7/5/UJU4PuZ/SewmDyoEZGNuIn3GQVvDTez07/6vRGjAwIFYPs7xqOs4u7ZGwiqwXplvFT002xkqDlBa2VLtT3vRdEQRtNF+r73guioI2mC/V97wVR0EbThfq+94IoaKPpQn3/8FAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAFEF6caxlyVWPzLFV9QDJXmvVs3K4QbaTGILu5+KqM8GJlnvFCjdyvEg2E6t2Ll5GDEHXz3r7OLj/oN5CFz7drpNKBC3b8rAiXgwSVg2ZoOzlL4GgbFnr0sQTlMr+d4r2KSzajiQGpb8JY5+DaIKsC2MHqSTJyvXIAkHljxgUlpYZiiXoIu1M7md85eUqbfGOoQsDUSRBsvpTJYVtTHdOYkFVFzGbOIKyCZEAX1BWr2CRXfjCvj6KIOevurVUaoRNQlCDJuVnI844SFh/yovuvBAC08I0ZdzbQZCum4Sg/07FDUcWgybkZ4OTVQAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIsBdBl4WP2GezE0GdXVIjQ0GADQvSC4L1llflKpalv0I9lw0L0ms1ywX69/Mba5CJcjln+ufLx/XLOwWZKKzcvv/99efll58UZCR9u3777/t7+sogbSZ7+ec1T38//6AgM9evf7zl2a9f3inIzO1UhGn9Zph+U2oVNi1IvyFUrbJOOQ7aKBQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEOB/xyzubSoZLl0AAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
</div>
<div id="section-1" class="section level1">
<h1>2021-09-23</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="section-2" class="section level3">
<h3>3.4</h3>
<p>The Rayleigh density [156, Ch. 18] is <span class="math display">\[\begin{equation}
f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\qquad x\ge 0,\ \sigma&gt;0.
\end{equation}\]</span> Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(σ\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(σ\)</span>) samples for several choices of <span class="math inline">\(σ &gt; 0\)</span> and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(σ\)</span> (check the histogram).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rayleigh<span class="ot">&lt;-</span><span class="cf">function</span>(sigma){<span class="co">#inverse transform algorithm </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)<span class="co">#Uniform(0,1)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="co">#inverse transform of exponential distribution</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(y)<span class="co">#generate random samples from the Rayleigh distribution</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x, <span class="at">prob=</span>T,<span class="at">main=</span><span class="fu">bquote</span>(<span class="st">&#39;sigma=&#39;</span><span class="sc">*</span>.(sigma)),<span class="at">nclass=</span><span class="dv">20</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">ceiling</span>(<span class="fu">max</span>(x)),<span class="fl">0.01</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y,y<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">*</span>y<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)) {</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rayleigh</span>(sigma[i])</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtttmtv+QOgCQZgCQtpCQ2/+2ZgC2/7a2///T09PbkDrb/9vb////tmb/25D//7b//9v////dTNS/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJfUlEQVR4nO2dYXujKBRG6bbdbWa3mZ3sxBmb5v//zRXRxCjygoBc7Xs+9GnTFPUULuAlqK7EiSp9AtKhIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgKIEfR5fP695K+UUm/pz+bOtgVdDkrzkuF8esQIWkSl3VwOTz/yHWLTgrpaV6n3fMcoLujUNJE/fvYXq9vM07+vTVQ5Pf866vCio0zbhGplwk3XrMxfaS6H/rsclBZ0aq+1aSOtoI9Xc+2toO/6u3+O3c9V/5uRoOb1JdHdm8KCLgddO+q2pjz/bmpLo6KxpAUpI6z5WjdfTDW5HCYytOGchooL6q9OC/p47RqTFqQj7+fx3vpMn25zUeXsxko3sarvp7WF2kTbjzYG3dUMW5+uS6MY1GnMRGlBXUjRzcspSL/trW1iU0HmvZkoLkijRzKTJvYoyLgbxaDuxz3XIKPk82gEPQTpsaCXYcTqOLXaqpyTjdI1yHTzzdVPuvlpE3tsV5ru1R33Yl2UfrcMFEdBunXxfhrNKr7QZHVAG6SlIEqQCbp5J5+hiBJ0j0hykCXoFpHkIEyQPCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgKECWrXK03Wee2aIEG3xYB13lVdkggR9Hm8aamyLv+XRIigy+G2cqf+Mo2MNQgQGIO6KhQdg7rF8nGFrELYOfarlaPrjzpr9ico3WEpCBx2p4Kqfg1qFdmL7VRQ9fSj+4wgBdkw3Xz7yQkKstEPFE/PvynIxm2geHqJE9QOFXYo6NawmuHQoyB1w+eQzbvUWSvanaDbUHr2Q5C4uE6krj87HEknKK51c95nDEpRnOrUmK8bMLTwFOeCNCpOPQrawB3flWuQuj7WIPlT+nUFqZGgDUTqVQVpGSNB4uNQ4qwGEHSdCpLelSXOajiLU3ZBsg0lviftFtR+mQoSbShxVsNVnJoVJLkvW7EGmd9NBZ312GgXgjyyGo7i1H0WNhJ03o0gnNVwCbqqkZq7IMET+/XGQQ5BZwq6D6KtggT39bcTa1pPgj1FZq5zEH42K8jkdGJXtcwJ6mPxnKCtNLFoR7OC1BkIkjoYGp9TFbd+LEKQ0Gr0cE51mzhdtvW1pbjBy8qjBkkXpMc4xkzE6qhZQWMfE0FSR4uDXizFzmExgmQOhu6Cvhk/i6oPyov5CBI6WpwIisyZzrxs8TEVJLkXO93rQJ5u3kOQzNHipAYlKm708g4E5SxO+QmSHYNyFrd9QZfDm2Uf68XFTV71FSTQ0Bo1SFGQuzjlGaRF5uqHU403+JCKZYnDnQg6mT3lT47bZssShypEkDhDg7nY+1XvrO+YaixM+yjfcZDuxWQL0tukO6YaCxOHYYKkGRo0sRfz1Ir5JraoBo2TYWgcJFdQMxDSD29w3blfkjg0d8J8u3l5N16zJw7v9xI9BBlLCy4jH9nHQfsRlOQj3wkECZuRDYJ0is/pWgTN+5gTJMrQoJtP8VH4XQuCT2u4TfjnG2IaQZIM3c7F3cH370HNMIkgUWOh+7nUHg/8gBYnlzZZseAlSJCh4eoOj15sxuJ82meJIFHDxdzjoCWCzpKSiDIFnUUKah+Qd4rr7MeXNV1W5ilIYBOrn35UejbvZcj341BLBckZDA26+bf2Jkba1POOBOmBohYUtzNQMkHyYlBfg05RO7uMLsuytNVbkBBD4xjkfnZ7aFZDLRpJd4JkDIYee7H2webzBGc1YgS146Goa0tCyCmE35OOEyRiMBRyCoFZDfvqcX9BMkaLo7kYyKsG1SD72t8QQZJi0KnbOMm5wCwsqxEtSERP1p1C3Qfnj1dXLxaU1diToMF9Hldu3re47vtoQXJi0GAGlm6qYV/7GyaovKFeUKJNSJMLKj5cFC7ItNKIE4pGvKDS42npgoqPp3tBMOMVUlz3vbcE5+9ECMpSXCpBEoJ0luISCSrc16c5uDUvlkrQXpvYzLq7JYJKGtqGoIKGNiGoZLJ+E4JKzjeyCZpb+7tE0LlgHMonKGEvdi5oaEOCyhjajqBCkTrsoP6Jw9mP+CwXVMZQ0DEDEocq5Ui6a2JF+rIsicNBRiydIGMp6mKXkCVxqNrrySCogKE8NSijoLUNBcYgv8Rhd6c0j6CVHYUdzDNxOMiIpRa0ei3KMg7KK2hdQxsVtF5DyzJQzC2okxR56X5kGSi6FgUlErSaokwDxZUErSApz0BxFUFDTVEOnGy4Bg1eyFib0gwUR2kfJZqMgtI9RnQ7lF+hJBwKAiwUFPuMw+2QpQaVDcIICYJCXk7w5hTHm4OCAIknq85C9y8IT1adhe5ekMdUw1no7gV5r4X9qoJYgxA4q+EsdP+CfCerX1fQF4SCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB0guqrdtYtXezrfdIbJumfbwqy2Nx9RM88X6zpoC/fjoP6k9yQXofmXpi6PPYvFTZngVcW+6d1M1L08czVLpkP0OXg77jOX/QAFILMncdJ1vImF13LPnYdvtPaxnjN5sdarw2p6lN3mX2oCGkFuQ8qWnNulbP3yeCPv607TTnL6hWb4N75paDhpBcUHtxM/f0p9vmN2+fxqD6j/8OltgR0MSGJxC5V39qQeb/Zf+vTe9k68Y0FVTpBmLZ29se/u2ncbMCbp9DVhRUT8OlfevP6slaC3VV+Hj1u9zbH1sOGsZ6Tczyr2zfbBHU/vV4N7WgkNufQGz9WTFI2/bXq7oFKaO4Yq5uHKpdjXdCJ8i9qZ8XK3Xz1/k9Yqc1yGRwx7XQqPfc3si8zb0xrR8rDRQdscMyktahaZDG7d8YGoN83+wk/VSjsvU1XWOytQ/bVKO2ThFO/hOHVpDjoP5wsgqgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJIF6TXqg0eUbk+0gX1T3kvhnRBetH0t6gVUJGIF3Q9xS7kjUO+IN/F9ZkQL+jz+HfRLQnFC6qef03Wu66JdEF6zXTco18jkS7o1C6ZLhimpQsqDgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBPgf+y/s6G25lNIAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The histograms show the algorithm is good.</p>
</div>
<div id="section-3" class="section level3">
<h3>3.11</h3>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3, 1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1 − p_1\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_1 = 0.75\)</span>. Repeat with different values for p1 and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of p1 that produce bimodal mixtures.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>loc.mix<span class="ot">&lt;-</span><span class="cf">function</span>(p1){<span class="co">#generate 1000 samples from the mormal location mixture</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1000</span>,p1)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">&lt;-</span><span class="dv">1000</span><span class="sc">-</span>n1</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">c</span>(x1,x2)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x, <span class="at">prob=</span>T,<span class="at">main=</span><span class="fu">bquote</span>(<span class="st">&#39;p1=&#39;</span><span class="sc">*</span>.(p1)),<span class="at">nclass=</span><span class="dv">20</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;p1=0.75&#39;</span>)</span></code></pre></div>
<pre><code>## p1=0.75</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loc.mix</span>(<span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">loc.mix</span>(p)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the picture, we can see when <span class="math inline">\(p_1\ne0\)</span> or <span class="math inline">\(p_1\ne1\)</span>, the empirical distributions of the mixture are bimodal, and when <span class="math inline">\(p_1=0.5\)</span>, the distribution have two peak values obviously.</p>
</div>
<div id="section-4" class="section level3">
<h3>3.20</h3>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t),\ t \ge 0\}\)</span> that can be represented as the random sum <span class="math inline">\(X(t) =\sum^{N(t)}_{i=1}Y_i,\ t\ge 0\)</span>, where <span class="math inline">\(\{N(t),\ t \ge 0\}\)</span> is a Poisson process and <span class="math inline">\(Y1, Y2, \cdots\)</span> are iid and independent of <span class="math inline">\(\{N(t),\ t \ge 0\}\)</span>. Write a program to simulate a compound Poisson(<span class="math inline">\(λ\)</span>)–Gamma process (Y has a Gamma distribution). Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)] = \lambda tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = \lambda tE[Y_1^2]\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>poissongamma<span class="ot">&lt;-</span><span class="cf">function</span>(lambda,alpha,beta){<span class="co">#lambda is the parameter of Poisson process, alpha and beta are the parameters of Gamma distribution</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="dv">10000</span><span class="co">#number of samples</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="dv">1000</span>,alpha,beta)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    T<span class="ot">&lt;-</span><span class="fu">rexp</span>(<span class="dv">1000</span>,lambda)<span class="co">#interval times</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    S<span class="ot">&lt;-</span><span class="fu">cumsum</span>(T)<span class="co">#arrival times</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    N<span class="ot">&lt;-</span><span class="fu">min</span>(<span class="fu">which</span>(S<span class="sc">&gt;</span>t))<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(y[<span class="dv">1</span><span class="sc">:</span>N])</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">mean</span>(x),<span class="fu">var</span>(x),lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>alpha<span class="sc">/</span>beta,lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>(alpha<span class="sc">+</span>alpha<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span>))<span class="co">#output mean and variance of X(t) and lambda*t*E[Y] and lambda*t*E[Y^2]</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">poissongamma</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## For example, lambda=1, alpha=2, beta=3:</code></pre>
<pre><code>## E[X(10)]= 6.65911</code></pre>
<pre><code>## Var[X(10)]= 6.661607</code></pre>
<pre><code>## lambda*t*E[Y]= 6.666667</code></pre>
<pre><code>## lambda*t*E[Y^2]= 6.666667</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x.mean.es<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x.var.es<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>x.mean.th<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>x.var.th<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">poissongamma</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span>),<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span>),<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span>))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  x.mean.es[i]<span class="ot">&lt;-</span>p[<span class="dv">1</span>]</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  x.var.es[i]<span class="ot">&lt;-</span>p[<span class="dv">2</span>]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  x.mean.th[i]<span class="ot">&lt;-</span>p[<span class="dv">3</span>]</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  x.var.th[i]<span class="ot">&lt;-</span>p[<span class="dv">4</span>]</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.mean.es,x.mean.th,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">EX</span>(<span class="dv">10</span>)),<span class="at">ylab=</span><span class="fu">expression</span>(lambda<span class="sc">*</span>t<span class="sc">*</span>EY))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.var.es,x.var.th,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">Var</span>(<span class="fu">X</span>(<span class="dv">10</span>))),<span class="at">ylab=</span><span class="fu">expression</span>(lambda<span class="sc">*</span>t<span class="sc">*</span>EY<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(x.mean.es,x.mean.th),<span class="at">digits =</span> <span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x.mean.es</th>
<th align="right">x.mean.th</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10.0</td>
<td align="right">10.0</td>
</tr>
<tr class="even">
<td align="right">8.0</td>
<td align="right">8.0</td>
</tr>
<tr class="odd">
<td align="right">24.1</td>
<td align="right">24.0</td>
</tr>
<tr class="even">
<td align="right">40.0</td>
<td align="right">40.0</td>
</tr>
<tr class="odd">
<td align="right">50.4</td>
<td align="right">50.0</td>
</tr>
<tr class="even">
<td align="right">199.9</td>
<td align="right">200.0</td>
</tr>
<tr class="odd">
<td align="right">60.1</td>
<td align="right">60.0</td>
</tr>
<tr class="even">
<td align="right">16.7</td>
<td align="right">16.7</td>
</tr>
<tr class="odd">
<td align="right">45.0</td>
<td align="right">45.0</td>
</tr>
<tr class="even">
<td align="right">20.0</td>
<td align="right">20.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(x.var.es,x.var.th),<span class="at">digits =</span> <span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x.var.es</th>
<th align="right">x.var.th</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.2</td>
<td align="right">5.0</td>
</tr>
<tr class="even">
<td align="right">8.0</td>
<td align="right">8.0</td>
</tr>
<tr class="odd">
<td align="right">19.0</td>
<td align="right">19.2</td>
</tr>
<tr class="even">
<td align="right">52.9</td>
<td align="right">53.3</td>
</tr>
<tr class="odd">
<td align="right">303.2</td>
<td align="right">300.0</td>
</tr>
<tr class="even">
<td align="right">1221.3</td>
<td align="right">1200.0</td>
</tr>
<tr class="odd">
<td align="right">180.7</td>
<td align="right">180.0</td>
</tr>
<tr class="even">
<td align="right">11.2</td>
<td align="right">11.1</td>
</tr>
<tr class="odd">
<td align="right">90.0</td>
<td align="right">90.0</td>
</tr>
<tr class="even">
<td align="right">50.2</td>
<td align="right">50.0</td>
</tr>
</tbody>
</table>
<p>From the pictures and tables above the means and the variances estimated of <span class="math inline">\(X(10)\)</span> for several choices of the parameters are accurate compared with the theoretical values.</p>
</div>
</div>
</div>
<div id="section-5" class="section level1">
<h1>2021-09-30</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="section-6" class="section level3">
<h3>5.4</h3>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2, \cdots, 0.9\)</span>. Compare the estimates with the values returned by the pbeta function in R.</p>
<p>Cdf of <span class="math inline">\(Beta(3,3)\)</span> is <span class="math display">\[\begin{equation}
F(x)=\frac{\int_{0}^{x}u^2(1-u)^2du}{\int_{0}^{1}v^2(1-v)^2dv}.
\end{equation}\]</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>F<span class="ot">&lt;-</span><span class="cf">function</span>(x){<span class="co">#Monte Carlo estimate of the Beta(3, 3)</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(m, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> x)<span class="co">#u~U(0,x)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  f1<span class="ot">&lt;-</span><span class="fu">mean</span>(x<span class="sc">*</span>u<span class="sc">*</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  v<span class="ot">&lt;-</span><span class="fu">runif</span>(m, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)<span class="co">#v~U(0,1)</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  f2<span class="ot">&lt;-</span><span class="fu">mean</span>(v<span class="sc">*</span>v<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>v)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>v))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(f1<span class="sc">/</span>f2)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>beta_estimated<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">9</span>)<span class="co">#Monte Carlo estimate of the Beta(3, 3)</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>beta_true<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">9</span>)<span class="co">#values returned by the pbeta function</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  beta_estimated[i]<span class="ot">&lt;-</span><span class="fu">F</span>(<span class="fl">0.1</span><span class="sc">*</span>i)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  beta_true[i]<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="fl">0.1</span><span class="sc">*</span>i,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),beta_estimated,beta_true),<span class="dv">5</span>))</span></code></pre></div>
<pre><code>##           beta_estimated beta_true
##  [1,] 0.1        0.00856   0.00856
##  [2,] 0.2        0.05762   0.05792
##  [3,] 0.3        0.16226   0.16308
##  [4,] 0.4        0.31975   0.31744
##  [5,] 0.5        0.49944   0.50000
##  [6,] 0.6        0.68887   0.68256
##  [7,] 0.7        0.83313   0.83692
##  [8,] 0.8        0.93025   0.94208
##  [9,] 0.9        0.97529   0.99144</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(beta_estimated,beta_true,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">xlab =</span> <span class="st">&quot;Monte Carlo estimate&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;pbeta function&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the table and picture above, we can see that Monte Carlo estimate and the values returned by the pbeta function are nearly same.</p>
</div>
<div id="section-7" class="section level3">
<h3>5.9</h3>
<p>The Rayleigh density [156, (18.76)] is <span class="math display">\[\begin{equation}
f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\qquad x\ge 0,\ \sigma&gt;0.
\end{equation}\]</span> Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>?</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>rayleigh<span class="ot">&lt;-</span><span class="cf">function</span>(sigma, <span class="at">R=</span><span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>){<span class="co">#inverse transform algorithm </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)<span class="co">#Uniform(0,1)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>antithetic) </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    v<span class="ot">&lt;-</span><span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>) </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    v<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>(sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">+</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>v)))<span class="sc">/</span><span class="dv">2</span><span class="co">#(X+X&#39;)/2 and (X1+X2)/2</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>anti.var<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>)<span class="co">#standard deviation using antithetic variables </span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>notanti.var<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>)<span class="co">#standard deviation without using antithetic variables</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>per<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>)<span class="co">#percent reduction in variance</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  anti.var[i]<span class="ot">&lt;-</span><span class="fu">var</span>(<span class="fu">rayleigh</span>(<span class="at">sigma =</span> sigma[i]))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  notanti.var[i]<span class="ot">&lt;-</span><span class="fu">var</span>(<span class="fu">rayleigh</span>(<span class="at">sigma =</span> sigma[i], <span class="at">anti=</span> <span class="cn">FALSE</span>))</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  per[i]<span class="ot">&lt;-</span><span class="dv">100</span><span class="sc">*</span>(notanti.var[i]<span class="sc">-</span>anti.var[i])<span class="sc">/</span>notanti.var[i]</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(sigma,anti.var,notanti.var,per),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>##      sigma anti.var notanti.var     per
## [1,]     1   0.0110      0.2136 94.8359
## [2,]     3   0.0972      1.9120 94.9177
## [3,]     5   0.3007      5.4898 94.5227
## [4,]    10   1.1762     21.2837 94.4735
## [5,]    20   4.4634     84.6803 94.7292
## [6,]    30   9.6902    199.8810 95.1520</code></pre>
</div>
<div id="section-8" class="section level3">
<h3>5.13</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[\begin{equation}
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},\ x&gt;1.
\end{equation}\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\begin{equation}
\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx
\end{equation}\]</span> by importance sampling? Explain.</p>
<p>The candidates for the importance functions are normal distribution and Rayleigh distribution: <span class="math display">\[\begin{equation}
f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},\ -\infty&lt;x&lt;\infty,
\end{equation}\]</span> <span class="math display">\[\begin{equation}
f_2(x)=xe^{-\frac{x^2}{2}},\ x\ge 0.
\end{equation}\]</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100000</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span>variance<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">*</span>x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(m)<span class="co">#using f1</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>variance[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">var</span>(fg)<span class="sc">/</span>m</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>rayleigh1<span class="ot">&lt;-</span><span class="cf">function</span>(sigma, <span class="at">R=</span><span class="dv">10000</span>){<span class="co">#inverse transform algorithm </span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(R)<span class="co">#Uniform(0,1)</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="co">#generate random samples from the Rayleigh distribution</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rayleigh1</span>(<span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">R =</span> m)<span class="co">#using f2</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span>(x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>variance[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">var</span>(fg)<span class="sc">/</span>m</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cbind</span>(<span class="at">theta.hat=</span><span class="fu">round</span>(theta.hat,<span class="dv">4</span>),variance))</span></code></pre></div>
<pre><code>##      theta.hat     variance
## [1,]    0.4034 1.277068e-05
## [2,]    0.3994 1.289674e-06</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">1.01</span>,<span class="dv">4</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">g</span>(x),<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;f(x)&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Importance functions with g(x)&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>),<span class="at">col=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>,<span class="st">&quot;f1(x)&quot;</span>,<span class="st">&quot;f2(x)&quot;</span>),<span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">g</span>(x)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>),<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;g(x)/f(x)&quot;</span>,<span class="at">main =</span> <span class="st">&quot;The ratios g(x)/f(x)&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">g</span>(x)<span class="sc">/</span>(x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>)),<span class="at">col=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)/f1(x)&quot;</span>,<span class="st">&quot;g(x)/f2(x)&quot;</span>),<span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">g</span>(x)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.020   3.089   6.275   7.025  10.579  16.000</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">g</span>(x)<span class="sc">/</span>(x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.4029  0.7011  0.9994  0.9994  1.2976  1.5958</code></pre>
<p>From the results above, we can see that when the importance function is Rayleigh distribution, the variance in estimating is smaller. And from the two pictures above, density function of Rayleigh distribution is more approach to <span class="math inline">\(g(x)\)</span> and the ratio <span class="math inline">\(g(x)/f_2(x)\)</span> is nearly constant, so the variance is smaller.</p>
</div>
<div id="section-9" class="section level3">
<h3>5.14</h3>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[\begin{equation}
\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx
\end{equation}\]</span> by importance sampling.</p>
<p>From the question 5.13, we choose the density function of Rayleigh distribution as the importance function.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rayleigh1</span>(<span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">R =</span> m)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span>(x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>theta.hat</span></code></pre></div>
<pre><code>## [1] 0.3991013</code></pre>
</div>
</div>
</div>
<div id="section-10" class="section level1">
<h1>2021-10-14</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).</p>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level. (1)What is the corresponding hypothesis test problem? (2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why? (3)Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="section-11" class="section level3">
<h3>6.5</h3>
<p>T统计量为 <span class="math display">\[\begin{equation*}
T=\frac{\sqrt{n}(\bar{X}-\mu)}{S}\sim t_{n-1}
\end{equation*}\]</span> 从而可以得到置信系数为<span class="math inline">\(\alpha\)</span>时的对称t-区间为<span class="math inline">\((\bar{X}-St_{n-1}(\alpha/2)/\sqrt{n},\bar{X}+St_{n-1}(\alpha/2)/\sqrt{n})\)</span>。</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#卡方分布均值的t-检验</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span><span class="co">#单次实验的样本量</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span><span class="co">#置信系数</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>CL<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)<span class="co">#生成卡方分布随机数</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n),<span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n))<span class="co">#计算置信区间</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {<span class="co">#计算包含真实值的置信区间数量</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(CL[<span class="dv">1</span>,i]<span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span> CL[<span class="dv">2</span>,i]<span class="sc">&lt;</span><span class="dv">2</span>) s<span class="ot">&lt;-</span>s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>s<span class="sc">/</span><span class="dv">1000</span><span class="co">#包含真实值的置信区间比例</span></span></code></pre></div>
<pre><code>## [1] 0.926</code></pre>
<p>在这个实验中，约有92.6% 的置信区间包含真实的均值<span class="math inline">\(\mu=20\)</span>，与在正态分布时的95%比例非常相近。在例子6.4中，我们分别考虑在正态分布和<span class="math inline">\(\chi^2(2)\)</span>分布下估计方差时置信区间包含真实值的概率。</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#正态分布的方差检验</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span><span class="co">#单次实验的样本量</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span><span class="co">#置信系数</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>UCL<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)<span class="co">#生成正态分布随机样本</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  (n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">qchisq</span>(alpha,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="co">#计算置信区间</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(UCL<span class="sc">&gt;</span><span class="dv">4</span>)<span class="co">#包含真实值的置信区间比例</span></span></code></pre></div>
<pre><code>## [1] 0.943</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#卡方分布的方差检验</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span><span class="co">#单次实验的样本量</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span><span class="co">#置信系数</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>UCL<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)<span class="co">#生成卡方分布随机样本</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  (n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">qchisq</span>(alpha,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="co">#计算置信区间</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(UCL<span class="sc">&gt;</span><span class="dv">4</span>)<span class="co">#包含真实值的置信区间比例</span></span></code></pre></div>
<pre><code>## [1] 0.813</code></pre>
<p>在检验正态分布方差的实验中，置信区间包含真实值的比例大约是94.3%，与95%非常接近；而在卡方分布方差的实验中，置信区间包含真实值的比例只有81.3%，与95%相差较多。</p>
<p>通过上面的实验与比较，我们可以发现t-区间在偏离正态情况时估计均值要比偏离正态时方差估计区间更为稳健。</p>
</div>
<div id="a" class="section level3">
<h3>6.A</h3>
<p>取<span class="math inline">\(\alpha=0.05\)</span>，令每次实验的样本量为<span class="math inline">\(n=20\)</span>。</p>
<p>(1)<span class="math inline">\(\chi^2(1)\)</span>:<span class="math inline">\(\mu_0=1\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span><span class="co">#真实均值</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span><span class="co">#实验次数</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)<span class="co">#储存每次实验的p-value</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">1</span>)<span class="co">#生成卡方分布样本</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  ttest<span class="ot">&lt;-</span><span class="fu">t.test</span>(x,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">mu=</span>mu0)<span class="co">#双边t检验</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  p[i]<span class="ot">&lt;-</span>ttest<span class="sc">$</span>p.value</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>p.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(p<span class="sc">&lt;</span>alpha)<span class="co">#I型错误率</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>se.hat<span class="ot">&lt;-</span><span class="fu">sqrt</span>(p.hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.hat)<span class="sc">/</span>m)<span class="co">#估计的标准差</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat,se.hat))</span></code></pre></div>
<pre><code>## [1] 0.100400000 0.003005326</code></pre>
<p>(2)<span class="math inline">\(Uniform(0,2)\)</span>:<span class="math inline">\(\mu_0=1\)</span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span><span class="co">#真实均值</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span><span class="co">#实验次数</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)<span class="co">#储存每次实验的p-value</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="at">min =</span> <span class="dv">0</span>,<span class="at">max =</span> <span class="dv">2</span>)<span class="co">#生成均匀分布样本</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  ttest<span class="ot">&lt;-</span><span class="fu">t.test</span>(x,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">mu=</span>mu0)<span class="co">#双边t检验</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  p[i]<span class="ot">&lt;-</span>ttest<span class="sc">$</span>p.value</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>p.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(p<span class="sc">&lt;</span>alpha)<span class="co">#I型错误率</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>se.hat<span class="ot">&lt;-</span><span class="fu">sqrt</span>(p.hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.hat)<span class="sc">/</span>m)<span class="co">#估计的标准差</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat,se.hat))</span></code></pre></div>
<pre><code>## [1] 0.050200000 0.002183574</code></pre>
<p>(3)<span class="math inline">\(Exponential(1)\)</span>:<span class="math inline">\(\mu_0=1\)</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span><span class="co">#真实均值</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span><span class="co">#实验次数</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)<span class="co">#储存每次实验的p-value</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="at">rate=</span><span class="dv">1</span>)<span class="co">#生成指数分布样本</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  ttest<span class="ot">&lt;-</span><span class="fu">t.test</span>(x,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">mu=</span>mu0)<span class="co">#双边t检验</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  p[i]<span class="ot">&lt;-</span>ttest<span class="sc">$</span>p.value</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>p.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(p<span class="sc">&lt;</span>alpha)<span class="co">#I型错误率</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>se.hat<span class="ot">&lt;-</span><span class="fu">sqrt</span>(p.hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.hat)<span class="sc">/</span>m)<span class="co">#估计的标准差</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat,se.hat))</span></code></pre></div>
<pre><code>## [1] 0.08120000 0.00273142</code></pre>
<p>从上面的实验结果我们可以看出均匀分布的I型错误率是最接近名义显著水平<span class="math inline">\(\alpha=0.05\)</span>，而分布<span class="math inline">\(\chi^2(1)\)</span>的I型错误率超出名义显著水平最多。由此可见t检验对偏离正态程度较轻时具有稳健性。</p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<p>(1)What is the corresponding hypothesis test problem?</p>
<p>令<span class="math inline">\(p_1=\)</span>使用第一种方法检验的功效, <span class="math inline">\(p_2=\)</span>使用第二种方法的功效，从而我们得到假设检验问题为 <span class="math display">\[\begin{equation*}
H_0:p_1=p_2\leftrightarrow H_1:p_1\neq p_2.
\end{equation*}\]</span></p>
<p>(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p>
<p>Z-test适合大样本时的正态分布样本检验或者近似正态分布样本检验，并且要求数据方差已知；而t-test可以用于小样本检验正态分布或近似正态分布样本，且不需要方差已知。两样本t-test要求两组样本是独立的两组样本，而配对t-test适用于同一组个体进行不同处理后结果的比较。 McNemar test是非参数检验，用于配对计数资料的分析，主要分析配对资料中控制组和处理组的频率或比率是否有差异，只适用于二分变量。由题意，我们是对同一组样本利用两种方法进行处理，所以可以使用配对t-test或者McNemar test。</p>
<p>(3)Please provide the least necessary information for hypothesis testing.</p>
<p>我们需要知道两种方法得到的功效是否已知分布，是否服从正态或者近似正态分布，如果服从正态分布或者近似正态分布，可以使用配对t-test，若是分布未知，且偏离正态分布程度较重，则使用McNemar test。</p>
</div>
</div>
</div>
<div id="section-12" class="section level1">
<h1>2021-10-21</h1>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R).</p>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\begin{equation*}
\beta_{1,d}=E[(X-\mu)^{T}\Sigma^{-1}(Y-\mu)]^3.
\end{equation*}\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[\begin{equation*}
b_{1,d}=\frac{1}{n^2}\sum^{n}_{i,j=1}((X_i-\bar{X})^T\hat{\Sigma}^{-1}(X_j-\bar{X}))^3,
\end{equation*}\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>先考虑例6.8中的实验。先计算正态偏度检验的I型错误率，取置信系数<span class="math inline">\(\alpha=0.05\)</span>，利用统计量<span class="math inline">\(b_{1,d}\)</span>的渐近分布<span class="math inline">\(\chi^2(d(d+1)(d+2)/6)\)</span>，样本数量<span class="math inline">\(n=10,20,30,50,100,500\)</span>。</p>
<p>卡方分布下样本数量不同情况时的<span class="math inline">\(b_{1,d}\)</span>临界值计算，其中样本维数<span class="math inline">\(d=3\)</span>：</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>cv.n<span class="ot">&lt;-</span><span class="cf">function</span>(d){<span class="co">#样本数量不同时临界值的计算，其中d为数据维度</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)<span class="co">#样本数量</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  cv<span class="ot">&lt;-</span><span class="dv">6</span><span class="sc">*</span><span class="fu">qchisq</span>(<span class="fl">0.95</span>,<span class="at">df=</span>d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)<span class="sc">/</span>n<span class="co">#不同样本数量下的临界值</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cv)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>cv<span class="ot">&lt;-</span><span class="fu">cv.n</span>(<span class="dv">3</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>),<span class="fu">c</span>(<span class="st">&quot;cv&quot;</span>,<span class="fu">round</span>(cv,<span class="dv">4</span>))))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="left">10</td>
<td align="left">20</td>
<td align="left">30</td>
<td align="left">50</td>
<td align="left">100</td>
<td align="left">500</td>
</tr>
<tr class="even">
<td align="left">cv</td>
<td align="left">10.9842</td>
<td align="left">5.4921</td>
<td align="left">3.6614</td>
<td align="left">2.1968</td>
<td align="left">1.0984</td>
<td align="left">0.2197</td>
</tr>
</tbody>
</table>
<p>接下来计算偏度统计量:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">&lt;-</span><span class="cf">function</span>(x){<span class="co">#计算样本X偏度统计量的函数b_{1,d}</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">ncol</span>(x)<span class="co">#样本数量</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">nrow</span>(x)<span class="co">#样本的数据维度</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  xbar<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(x)<span class="co">#样本的均值</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  xcov<span class="ot">&lt;-</span><span class="fu">cov</span>(<span class="fu">t</span>(x<span class="sc">-</span>xbar))<span class="co">#样本的协方差阵</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  x.cen<span class="ot">&lt;-</span>x<span class="sc">-</span>xbar<span class="co">#样本数据中心化</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>((<span class="fu">t</span>(x.cen)<span class="sc">%*%</span><span class="fu">solve</span>(xcov)<span class="sc">%*%</span>x.cen)<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>n<span class="sc">/</span>n)<span class="co">#输出偏度统计量的函数b_{1,d}</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>随机生成样本<span class="math inline">\(X\sim N(0,S)\)</span>，其中 <span class="math display">\[\begin{equation*}
S=\left(
\begin{array}{ccc}
3 &amp; 2 &amp; 1\\
2 &amp; 3 &amp; 2\\
1 &amp; 2 &amp; 3\\
\end{array}
\right)
\end{equation*}\]</span> 是真实的协方差阵。取样本数量<span class="math inline">\(n=10,20,30,50,100,500\)</span>，此时样本维数为<span class="math inline">\(d=3\)</span>。假设检验为 <span class="math display">\[\begin{equation*}
H_0:b_{1,d}=0\leftrightarrow H_1:b_{1,d}\neq 0.
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>p.reject<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(n))<span class="co">#储存不同样本数量下拒接原假设的概率</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">500</span><span class="co">#每个样本数据下的实验次数</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  sktests<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">mvrnorm</span>(<span class="at">n=</span>n[i],<span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">Sigma=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dv">3</span>,<span class="dv">3</span>))))<span class="co">#生成n[i]个样本</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    sktests[j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">sk</span>(x))<span class="sc">&gt;=</span>cv[i])</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  p.reject[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(sktests)<span class="co">#拒绝原假设的概率</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.000 0.000 0.000 0.002 0.000</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>),<span class="fu">c</span>(<span class="st">&quot;p.reject&quot;</span>,<span class="fu">round</span>(p.reject,<span class="dv">4</span>))))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="left">10</td>
<td align="left">30</td>
<td align="left">50</td>
<td align="left">100</td>
<td align="left">500</td>
</tr>
<tr class="even">
<td align="left">p.reject</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0.002</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>由上述实验结果可以看出当样本量逐渐变大时，拒绝原假设的概率也趋近于置信系数<span class="math inline">\(\alpha=0.05\)</span>。</p>
<p>再考虑例6.10中的实验，考虑污染的正态分布 <span class="math display">\[\begin{equation*}
(1-\epsilon)N(0,S_1)+\epsilon N(0,S_2),\ 0\le\epsilon\le1.
\end{equation*}\]</span> 其中 <span class="math display">\[\begin{equation*}
S_1=\left(
\begin{array}{ccc}
10 &amp; 2 &amp; 1\\
2 &amp; 10 &amp; 2\\
1 &amp; 2 &amp; 10\\
\end{array}
\right),\ S_2=\left(
\begin{array}{ccc}
1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 1\\
\end{array}
\right).
\end{equation*}\]</span> 取<span class="math inline">\(\alpha=0.1,\ n=100\)</span>。</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span><span class="co">#置信系数</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span><span class="co">#样本数量</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">500</span><span class="co">#实验次数</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>epsilon<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">length</span>(epsilon)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>pwr<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,N)<span class="co">#功效</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>cv<span class="ot">&lt;-</span><span class="dv">6</span><span class="sc">*</span><span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">df=</span>d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)<span class="sc">/</span>n<span class="co">#临界值</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">10</span>),<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>s2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span>n)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  e<span class="ot">&lt;-</span>epsilon[j]</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  sktests<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {<span class="co">#生成污染的正态分布样本</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>      t<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e,e))</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(t<span class="sc">==</span><span class="dv">1</span>) x[,k]<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>,<span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">Sigma=</span>s1)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> x[,k]<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>,<span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">Sigma=</span>s2)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    sktests[i]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">sk</span>(x))<span class="sc">&gt;=</span>cv)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  pwr[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(sktests)</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon,pwr,<span class="at">type=</span><span class="st">&quot;b&quot;</span>,<span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">main=</span><span class="st">&quot;Empirical Power&quot;</span>)<span class="co">#绘制功效-epsilon图</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.1</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(pwr<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pwr)<span class="sc">/</span>m)<span class="co">#标准差</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon,pwr<span class="sc">+</span>se,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon,pwr<span class="sc">-</span>se,<span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>由以上结果可以看出，当<span class="math inline">\(\epsilon=0\)</span>或<span class="math inline">\(\epsilon=1\)</span>时也即样本服从多元正态分布时，功效曲线在水平线<span class="math inline">\(\alpha=0.1\)</span>附近。而<span class="math inline">\(0&lt;\epsilon&lt;1\)</span>时功效曲线位于水平线上方，也即拒绝原假设的概率大于0.10，其中经验功效大约在<span class="math inline">\(\epsilon=0.8\)</span>时达到最大。</p>
</div>
</div>
<div id="section-13" class="section level1">
<h1>2021-10-28</h1>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercises 7.7, 7.8, 7.9, and 7.B (pages 213, Statistical Computating with R).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section-14" class="section level3">
<h3>7.7</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#样本估计</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>lambda.hat<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values,<span class="at">decreasing =</span> T)<span class="co">#求解协方差矩阵的MLE估计矩阵的特征值并按降序排列</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span>lambda.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.hat)<span class="co">#样本估计</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(scor)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>theta.b<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,B)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {<span class="co">#bootstrap</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size=</span>n,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  lambda.b<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">eigen</span>(<span class="fu">cov</span>(scor[i,]))<span class="sc">$</span>values,<span class="at">decreasing =</span> T)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  theta.b[b]<span class="ot">&lt;-</span>lambda.b[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.b)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>bias<span class="ot">&lt;-</span><span class="fu">mean</span>(theta.b)<span class="sc">-</span>theta.hat<span class="co">#偏差</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sd</span>(theta.b)<span class="co">#标准差</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">list</span>(<span class="at">theta.hat=</span>theta.hat,<span class="at">bias=</span>bias,<span class="at">se=</span>se))</span></code></pre></div>
<pre><code>## $theta.hat
## [1] 0.619115
## 
## $bias
## [1] 0.0001943598
## 
## $se
## [1] 0.04611542</code></pre>
</div>
<div id="section-15" class="section level3">
<h3>7.8</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#jackknife</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>theta.jack<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  lambda.jack<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">eigen</span>(<span class="fu">cov</span>(scor[<span class="sc">-</span>i,]))<span class="sc">$</span>values,<span class="at">decreasing =</span> T)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  theta.jack[i]<span class="ot">&lt;-</span>lambda.jack[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.jack)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>bias<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)<span class="co">#偏差</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>)<span class="co">#标准差</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">list</span>(<span class="at">theta.hat=</span>theta.hat,<span class="at">bias=</span>bias,<span class="at">se=</span>se))</span></code></pre></div>
<pre><code>## $theta.hat
## [1] 0.619115
## 
## $bias
## [1] 0.001069139
## 
## $se
## [1] 0.0002632499</code></pre>
</div>
<div id="section-16" class="section level3">
<h3>7.9</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>stat<span class="ot">&lt;-</span><span class="cf">function</span>(dat,index){<span class="co">#参数statistic</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">eigen</span>(<span class="fu">cov</span>(dat[index,]))<span class="sc">$</span>values,<span class="at">decreasing =</span> T)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(scor,<span class="at">statistic =</span> stat,<span class="at">R=</span><span class="dv">2000</span>)<span class="co">#bootstrap</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(boot.obj,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))<span class="co">#计算percentile和BCa置信区间</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;precent&quot;</span>,ci<span class="sc">$</span>perc[<span class="dv">4</span>],ci<span class="sc">$</span>perc[<span class="dv">5</span>]),<span class="fu">c</span>(<span class="st">&quot;BCa&quot;</span>,ci<span class="sc">$</span>bca[<span class="dv">4</span>],ci<span class="sc">$</span>bca[<span class="dv">5</span>])),<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">precent</td>
<td align="left">0.516278859066827</td>
<td align="left">0.708649069662076</td>
</tr>
<tr class="even">
<td align="left">BCa</td>
<td align="left">0.513745105506653</td>
<td align="left">0.704789252691748</td>
</tr>
</tbody>
</table>
<p>从而得到95%的BCa置信区间为(0.5137,0.7048)。</p>
</div>
<div id="b" class="section level3">
<h3>7.B</h3>
<p>取置信系数<span class="math inline">\(\alpha=0.05\)</span>，随机变量<span class="math inline">\(X\)</span>的偏度<span class="math inline">\(\sqrt{\beta_1}\)</span>定义为 <span class="math display">\[\begin{equation*}
\sqrt{\beta_1}=\frac{E[(X-\mu_X)]^3}{\sigma_X^3}，
\end{equation*}\]</span> 其中<span class="math inline">\(\mu_X=E[X],\ \sigma_X^2=Var(X)\)</span>。假设为 <span class="math display">\[\begin{equation*}
H_0:\sqrt{\beta_1}=0\leftrightarrow H_1:\sqrt{\beta_1}\neq0.
\end{equation*}\]</span> 样本估计量为 <span class="math display">\[\begin{equation*}
\sqrt{b_1}=\frac{\frac{1}{n}\sum^{n}_{i=1}(X_i-\bar{X})^3}{(\frac{1}{n}\sum^{n}_{i=1}(X_i-\bar{X})^2)^{3/2}}.
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">&lt;-</span><span class="cf">function</span>(x,index){</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  xbar<span class="ot">&lt;-</span><span class="fu">mean</span>(x[index])</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  m3<span class="ot">&lt;-</span><span class="fu">mean</span>((x[index]<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">&lt;-</span><span class="fu">mean</span>((x[index]<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  m3<span class="sc">/</span>m2<span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>对于正态分布的样本,我们可以知晓偏度系数的真实值为0，在下面的实验中，随机选取一个正态分布样本计算偏度系数，进行蒙特卡洛实验算出bootstrap区间覆盖样本偏度系数的概率以及覆盖真实偏度系数的概率。</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#蒙特卡洛实验次数</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">10000</span>)<span class="co">#正态样本</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>sk.x<span class="ot">&lt;-</span><span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span><span class="fl">1.5</span><span class="co">#计算样本的偏度系数</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>sk.x</span></code></pre></div>
<pre><code>## [1] -0.02347698</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>sktests<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">6</span>,<span class="at">ncol=</span>m)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>sk.true<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">6</span>,<span class="at">ncol=</span>m)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {<span class="co">#进行蒙特卡洛实验</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bootstrap</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(x,<span class="at">statistic =</span> sk,<span class="at">R=</span><span class="dv">100</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(boot.obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">1</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&lt;=</span>b<span class="sc">$</span>normal[<span class="dv">2</span>])<span class="co">#样本偏度系数normal检验落入左侧</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">2</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&gt;=</span>b<span class="sc">$</span>normal[<span class="dv">3</span>])<span class="co">#样本偏度系数normal检验落入右侧</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">3</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&lt;=</span>b<span class="sc">$</span>basic[<span class="dv">4</span>])<span class="co">#样本偏度系数basic检验落入左侧</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">4</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&gt;=</span>b<span class="sc">$</span>basic[<span class="dv">5</span>])<span class="co">#样本偏度系数basic检验落入右侧</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">5</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&lt;=</span>b<span class="sc">$</span>percent[<span class="dv">4</span>])<span class="co">#样本偏度系数percent检验落入左侧</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">6</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&gt;=</span>b<span class="sc">$</span>percent[<span class="dv">5</span>])<span class="co">#样本偏度系数percent检验落入右侧</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">1</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="dv">0</span><span class="sc">&lt;=</span>b<span class="sc">$</span>normal[<span class="dv">2</span>])<span class="co">#真实偏度系数normal检验落入左侧</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">2</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="dv">0</span><span class="sc">&gt;=</span>b<span class="sc">$</span>normal[<span class="dv">3</span>])<span class="co">#真实偏度系数normal检验落入右侧</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">3</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="dv">0</span><span class="sc">&lt;=</span>b<span class="sc">$</span>basic[<span class="dv">4</span>])<span class="co">#真实偏度系数basic检验落入左侧</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">4</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="dv">0</span><span class="sc">&gt;=</span>b<span class="sc">$</span>basic[<span class="dv">5</span>])<span class="co">#真实偏度系数basic检验落入右侧</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">5</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="dv">0</span><span class="sc">&lt;=</span>b<span class="sc">$</span>percent[<span class="dv">4</span>])<span class="co">#真实偏度系数percent检验落入左侧</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">6</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="dv">0</span><span class="sc">&gt;=</span>b<span class="sc">$</span>percent[<span class="dv">5</span>])<span class="co">#真实偏度系数percent检验落入右侧</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>samplesk<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(sktests)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>truesk<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(sk.true)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;样本偏度系数&quot;</span>)</span></code></pre></div>
<pre><code>## 样本偏度系数</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;type&quot;</span>,<span class="st">&quot;miss on the left&quot;</span>,<span class="st">&quot;miss on the right&quot;</span>,<span class="st">&quot;coverage rate&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,samplesk[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(samplesk[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])),<span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>,samplesk[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(samplesk[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])),<span class="fu">c</span>(<span class="st">&quot;percet&quot;</span>,samplesk[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(samplesk[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">type</td>
<td align="left">miss on the left</td>
<td align="left">miss on the right</td>
<td align="left">coverage rate</td>
</tr>
<tr class="even">
<td align="left">normal</td>
<td align="left">0.049</td>
<td align="left">0.015</td>
<td align="left">0.936</td>
</tr>
<tr class="odd">
<td align="left">basic</td>
<td align="left">0.044</td>
<td align="left">0.013</td>
<td align="left">0.943</td>
</tr>
<tr class="even">
<td align="left">percet</td>
<td align="left">0.04</td>
<td align="left">0.017</td>
<td align="left">0.943</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;真实偏度系数&quot;</span>)</span></code></pre></div>
<pre><code>## 真实偏度系数</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;type&quot;</span>,<span class="st">&quot;miss on the left&quot;</span>,<span class="st">&quot;miss on the right&quot;</span>,<span class="st">&quot;coverage rate&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,truesk[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(truesk[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])),<span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>,truesk[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(truesk[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])),<span class="fu">c</span>(<span class="st">&quot;percet&quot;</span>,truesk[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(truesk[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">type</td>
<td align="left">miss on the left</td>
<td align="left">miss on the right</td>
<td align="left">coverage rate</td>
</tr>
<tr class="even">
<td align="left">normal</td>
<td align="left">0.026</td>
<td align="left">0.036</td>
<td align="left">0.938</td>
</tr>
<tr class="odd">
<td align="left">basic</td>
<td align="left">0.024</td>
<td align="left">0.034</td>
<td align="left">0.942</td>
</tr>
<tr class="even">
<td align="left">percet</td>
<td align="left">0.017</td>
<td align="left">0.031</td>
<td align="left">0.952</td>
</tr>
</tbody>
</table>
<p>可以看到用bootstrap得到的置信区间包含真实偏度系数的概率接近0.95，且真实值落入区间左侧和右侧的概率接近0.025，对于从正态分布得到的样本，则存在误差。</p>
<p>而对于卡方分布的样本,我们可以知晓<span class="math inline">\(\chi^2(5)\)</span>偏度系数的真实值为1.265，在下面的实验中，随机选取一个卡方分布样本计算偏度系数，进行蒙特卡洛实验算出bootstrap区间覆盖样本偏度系数的概率以及覆盖真实偏度系数的概率。</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#蒙特卡洛实验次数</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(<span class="dv">10000</span>,<span class="at">df=</span><span class="dv">5</span>)<span class="co">#正态样本</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>sk.x<span class="ot">&lt;-</span><span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span><span class="fl">1.5</span><span class="co">#计算样本的偏度系数</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>sk.x</span></code></pre></div>
<pre><code>## [1] 1.197984</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>sktests<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">6</span>,<span class="at">ncol=</span>m)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>sk.true<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">6</span>,<span class="at">ncol=</span>m)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {<span class="co">#进行蒙特卡洛实验</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(<span class="dv">1000</span>,<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bootstrap</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(x,<span class="at">statistic =</span> sk,<span class="at">R=</span><span class="dv">100</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(boot.obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">1</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&lt;=</span>b<span class="sc">$</span>normal[<span class="dv">2</span>])<span class="co">#样本偏度系数normal检验落入左侧</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">2</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&gt;=</span>b<span class="sc">$</span>normal[<span class="dv">3</span>])<span class="co">#样本偏度系数normal检验落入右侧</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">3</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&lt;=</span>b<span class="sc">$</span>basic[<span class="dv">4</span>])<span class="co">#样本偏度系数basic检验落入左侧</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">4</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&gt;=</span>b<span class="sc">$</span>basic[<span class="dv">5</span>])<span class="co">#样本偏度系数basic检验落入右侧</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">5</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&lt;=</span>b<span class="sc">$</span>percent[<span class="dv">4</span>])<span class="co">#样本偏度系数percent检验落入左侧</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  sktests[<span class="dv">6</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(sk.x<span class="sc">&gt;=</span>b<span class="sc">$</span>percent[<span class="dv">5</span>])<span class="co">#样本偏度系数percent检验落入右侧</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">1</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fl">1.265</span><span class="sc">&lt;=</span>b<span class="sc">$</span>normal[<span class="dv">2</span>])<span class="co">#真实偏度系数normal检验落入左侧</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">2</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fl">1.265</span><span class="sc">&gt;=</span>b<span class="sc">$</span>normal[<span class="dv">3</span>])<span class="co">#真实偏度系数normal检验落入右侧</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">3</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fl">1.265</span><span class="sc">&lt;=</span>b<span class="sc">$</span>basic[<span class="dv">4</span>])<span class="co">#真实偏度系数basic检验落入左侧</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">4</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fl">1.265</span><span class="sc">&gt;=</span>b<span class="sc">$</span>basic[<span class="dv">5</span>])<span class="co">#真实偏度系数basic检验落入右侧</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">5</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fl">1.265</span><span class="sc">&lt;=</span>b<span class="sc">$</span>percent[<span class="dv">4</span>])<span class="co">#真实偏度系数percent检验落入左侧</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  sk.true[<span class="dv">6</span>,j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fl">1.265</span><span class="sc">&gt;=</span>b<span class="sc">$</span>percent[<span class="dv">5</span>])<span class="co">#真实偏度系数percent检验落入右侧</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>samplesk<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(sktests)</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>truesk<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(sk.true)</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;样本偏度系数&quot;</span>)</span></code></pre></div>
<pre><code>## 样本偏度系数</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;type&quot;</span>,<span class="st">&quot;miss on the left&quot;</span>,<span class="st">&quot;miss on the right&quot;</span>,<span class="st">&quot;coverage rate&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,samplesk[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(samplesk[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])),<span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>,samplesk[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(samplesk[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])),<span class="fu">c</span>(<span class="st">&quot;percet&quot;</span>,samplesk[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(samplesk[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">type</td>
<td align="left">miss on the left</td>
<td align="left">miss on the right</td>
<td align="left">coverage rate</td>
</tr>
<tr class="even">
<td align="left">normal</td>
<td align="left">0.039</td>
<td align="left">0.046</td>
<td align="left">0.915</td>
</tr>
<tr class="odd">
<td align="left">basic</td>
<td align="left">0.036</td>
<td align="left">0.046</td>
<td align="left">0.918</td>
</tr>
<tr class="even">
<td align="left">percet</td>
<td align="left">0.027</td>
<td align="left">0.044</td>
<td align="left">0.929</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;真实偏度系数&quot;</span>)</span></code></pre></div>
<pre><code>## 真实偏度系数</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;type&quot;</span>,<span class="st">&quot;miss on the left&quot;</span>,<span class="st">&quot;miss on the right&quot;</span>,<span class="st">&quot;coverage rate&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,truesk[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(truesk[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])),<span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>,truesk[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(truesk[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])),<span class="fu">c</span>(<span class="st">&quot;percet&quot;</span>,truesk[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>],<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(truesk[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">type</td>
<td align="left">miss on the left</td>
<td align="left">miss on the right</td>
<td align="left">coverage rate</td>
</tr>
<tr class="even">
<td align="left">normal</td>
<td align="left">0.01</td>
<td align="left">0.118</td>
<td align="left">0.872</td>
</tr>
<tr class="odd">
<td align="left">basic</td>
<td align="left">0.01</td>
<td align="left">0.112</td>
<td align="left">0.878</td>
</tr>
<tr class="even">
<td align="left">percet</td>
<td align="left">0.006</td>
<td align="left">0.125</td>
<td align="left">0.869</td>
</tr>
</tbody>
</table>
<p>从上述结果可以看出，无论是真实值还是样本值，误差都比较大，且落入区间左右两侧的概率也不接近。</p>
</div>
</div>
</div>
<div id="section-17" class="section level1">
<h1>2021-11-04</h1>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span></code></pre></div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Exercise 8.2 (page 242, Statistical Computating with R).</p>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations. i. Unequal variances and equal expectations ii. Unequal variances and unequal expectations iii. Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) iv. Unbalanced samples (say, 1 case versus 10 controls) Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-18" class="section level3">
<h3>8.2</h3>
<p>我们选择每次重排检验得到的p值作为统计量，p值越大越支持原假设也即X与Y独立，p值越小越支持对立假设，因此ASL为 <span class="math display">\[\begin{equation}
\hat{p}=\frac{1+\#\{\hat{p}^{(b)}\le \hat{p}_0\}}{B+1}.
\end{equation}\]</span> 此时若<span class="math inline">\(\hat{p}&lt;\alpha\)</span>拒绝<span class="math inline">\(H_0\)</span>。</p>
<p>先随机生成两组独立数据X和Y。</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">100</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">Sigma =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">100</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">2</span>))</span></code></pre></div>
<p>再利用重排法：</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>spear<span class="ot">&lt;-</span><span class="cf">function</span>(z,ix){</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dims是x和y的维度</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>z[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="co">#x不改变</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>z[ix,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]<span class="co">#重排y的行</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cor.test</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">cbind</span>(x,y)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic =</span> spear,<span class="at">R=</span><span class="dv">999</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>tb<span class="ot">&lt;-</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tb<span class="sc">&lt;=</span>boot.obj<span class="sc">$</span>t0)</span></code></pre></div>
<pre><code>## [1] 0.678</code></pre>
<p>显著性水平为0.678，大于<span class="math inline">\(\alpha=0.05\)</span>时接受原假设即X与Y独立。</p>
<p>再生成两组不独立数据X和Y。</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">100</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">2</span>))</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>x</span></code></pre></div>
<p>再利用重排法：</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>spear<span class="ot">&lt;-</span><span class="cf">function</span>(z,ix){</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dims是x和y的维度</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>z[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="co">#x不改变</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>z[ix,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]<span class="co">#重排y的行</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cor.test</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">cbind</span>(x,y)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic =</span> spear,<span class="at">R=</span><span class="dv">999</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>tb<span class="ot">&lt;-</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tb<span class="sc">&lt;=</span>boot.obj<span class="sc">$</span>t0)</span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<p>显著性水平为0.001，小于<span class="math inline">\(\alpha=0.05\)</span>，拒绝原假设认为X与Y不独立。</p>
</div>
<div id="附加题" class="section level3">
<h3>附加题</h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>Tn<span class="ot">&lt;-</span><span class="cf">function</span>(z,ix,sizes,k){<span class="co">#进行NN的统计量计算</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">&lt;-</span>sizes[<span class="dv">1</span>]</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">&lt;-</span>sizes[<span class="dv">2</span>]</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z<span class="ot">&lt;-</span><span class="fu">data.frame</span>(z,<span class="dv">0</span>)<span class="co">#确保z不是向量以保证以下代码的正确性</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span>z[ix,]</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  NN<span class="ot">&lt;-</span><span class="fu">nn2</span>(<span class="at">data=</span>z,<span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="co">#NN</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  block1<span class="ot">&lt;-</span>NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]<span class="co">#寻找前n1个邻居</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  block2<span class="ot">&lt;-</span>NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]<span class="co">#寻找后n2个邻居</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  i1<span class="ot">&lt;-</span><span class="fu">sum</span>(block1<span class="sc">&lt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  i2<span class="ot">&lt;-</span><span class="fu">sum</span>(block2<span class="sc">&gt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  (i1<span class="sc">+</span>i2)<span class="sc">/</span>(k<span class="sc">*</span>n)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>eqdist.nn<span class="ot">&lt;-</span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic =</span> Tn,<span class="at">R=</span>R,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="at">sizes=</span>sizes,<span class="at">k=</span>k)<span class="co">#重排法</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  ts<span class="ot">&lt;-</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  p.value<span class="ot">&lt;-</span><span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol style="list-style-type: lower-roman">
<li>Unequal variances and equal expectations</li>
</ol>
<p>考虑二元正态分布X和Y，二者的均值都是零向量，但X的协方差阵为单位向量<span class="math inline">\(I\)</span>，Y的协方差阵为<span class="math inline">\(3I\)</span>。</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="dv">2</span><span class="co">#数据维度</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span>n2<span class="ot">&lt;-</span><span class="dv">50</span><span class="co">#样本数量</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n1,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="fu">diag</span>(<span class="dv">2</span>))</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n2,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="fu">diag</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">rbind</span>(x,y)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value<span class="co">#NN</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value<span class="co">#ENERGY</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">1</span>)<span class="sc">$</span>p.value<span class="co">#BALL</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.355 0.465 0.845</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.235 0.300 0.745</code></pre>
<p>可以看出Ball test是表现最好的，其次是energy test。</p>
<ol start="2" style="list-style-type: lower-roman">
<li>Unequal variances and unequal expectations</li>
</ol>
<p>考虑二元正态分布X和Y，二者的均值分别是<span class="math inline">\((0,0)\)</span>和<span class="math inline">\((5,6)\)</span>，但X的协方差阵为单位向量<span class="math inline">\(I\)</span>，Y的协方差阵为<span class="math inline">\(3I\)</span>。</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="dv">2</span><span class="co">#数据维度</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span>n2<span class="ot">&lt;-</span><span class="dv">50</span><span class="co">#样本数量</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n1,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="fu">diag</span>(<span class="dv">2</span>))</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n2,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="fu">diag</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">rbind</span>(x,y)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value<span class="co">#NN</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value<span class="co">#ENERGY</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">1</span>)<span class="sc">$</span>p.value<span class="co">#BALL</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.95 1.00 1.00</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.005</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
<p>Ball test和energy test的表现明显比NN好。</p>
<ol start="3" style="list-style-type: lower-roman">
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
</ol>
<p>考虑t正态分布X和混合正态分布Y，<span class="math inline">\(X\sim t(1),Y\sim 0.3N(0,1)+0.7N(3,2)\)</span>。</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="dv">2</span><span class="co">#数据维度</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span>n2<span class="ot">&lt;-</span><span class="dv">50</span><span class="co">#样本数量</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">rt</span>(n1,<span class="at">df=</span><span class="dv">1</span>))</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  s1<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n2,<span class="fl">0.3</span>)</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  s2<span class="ot">&lt;-</span>n2<span class="sc">-</span>s1</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>  y1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(s1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>  y2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(s2,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">c</span>(y1,y2)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">matrix</span>(y)</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">rbind</span>(x,y)</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value<span class="co">#NN</span></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value<span class="co">#ENERGY</span></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">1</span>)<span class="sc">$</span>p.value<span class="co">#BALL</span></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.835 1.000 0.990</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.01</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.560 0.940 0.895</code></pre>
<p>Ball test和energy test的表现明显比NN好。</p>
<ol start="4" style="list-style-type: lower-roman">
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
</ol>
<p>考虑二元正态分布X和Y，二者的均值都是零向量，但X的协方差阵为单位向量<span class="math inline">\(I\)</span>，Y的协方差阵为<span class="math inline">\(3I\)</span>，且二者数据量差很多。</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="dv">2</span><span class="co">#数据维度</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">&lt;-</span><span class="dv">90</span><span class="co">#样本数量</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n1,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="fu">diag</span>(<span class="dv">2</span>))</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n2,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="fu">diag</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">rbind</span>(x,y)</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value<span class="co">#NN</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value<span class="co">#ENERGY</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">1</span>)<span class="sc">$</span>p.value<span class="co">#BALL</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.12 0.07 0.52</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.08 0.04 0.37</code></pre>
<p>Ball test表现最好。</p>
<p>考虑t正态分布X和混合正态分布Y，<span class="math inline">\(X\sim t(1),Y\sim 0.3N(0,1)+0.7N(3,2)\)</span>，且二者数据量差很多。</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="dv">2</span><span class="co">#数据维度</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">&lt;-</span><span class="dv">90</span><span class="co">#样本数量</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">rt</span>(n1,<span class="at">df=</span><span class="dv">1</span>))</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  s1<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n2,<span class="fl">0.3</span>)</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  s2<span class="ot">&lt;-</span>n2<span class="sc">-</span>s1</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  y1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(s1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>  y2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(s2,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">c</span>(y1,y2)</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">matrix</span>(y)</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">rbind</span>(x,y)</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value<span class="co">#NN</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value<span class="co">#ENERGY</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">1</span>)<span class="sc">$</span>p.value<span class="co">#BALL</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.455 0.910 0.705</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.345 0.795 0.575</code></pre>
<p>energy test的表现最好，NN表现最差。</p>
<p>综上所述Ball test和energy test的表现明显比NN好。</p>
</div>
</div>
</div>
<div id="section-19" class="section level1">
<h1>2021-11-11</h1>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R).</p>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="section-20" class="section level3">
<h3>9.3</h3>
<p>取正态分布<span class="math inline">\(N(X_t,\sigma^2)\)</span>作为提议分布，丢弃链的前1000个迭代值。</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co">#标准柯西分布的密度函数</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co">#生成标准柯西分布的马尔科夫链</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>cauchy.chain<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,N,X1){</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#sigma为提议分布的标准差</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#N为链的长度</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#初始值为X1</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span>X1</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(N)</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>    xt<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,xt,sigma)</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>    num<span class="ot">&lt;-</span><span class="fu">f</span>(y)<span class="sc">*</span><span class="fu">dnorm</span>(xt,y,sigma)</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>    den<span class="ot">&lt;-</span><span class="fu">f</span>(xt)<span class="sc">*</span><span class="fu">dnorm</span>(y,xt,sigma)</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>    r<span class="ot">&lt;-</span>num<span class="sc">/</span>den</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u[i]<span class="sc">&lt;=</span>r) x[i]<span class="ot">&lt;-</span>y</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> x[i]<span class="ot">&lt;-</span>xt</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Gelman-Rubin method</span></span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>gelman.rubin<span class="ot">&lt;-</span><span class="cf">function</span>(psi){</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>  psi<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(psi)</span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">ncol</span>(psi)</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="fu">nrow</span>(psi)</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>  psi.means<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(psi)</span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a>  B<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">var</span>(psi.means)</span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a>  psi.w<span class="ot">&lt;-</span><span class="fu">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a>  W<span class="ot">&lt;-</span><span class="fu">mean</span>(psi.w)</span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a>  v.hat<span class="ot">&lt;-</span>W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>(B<span class="sc">/</span>n)</span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a>  r.hat<span class="ot">&lt;-</span>v.hat<span class="sc">/</span>W</span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-43"><a href="#cb106-43" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">1</span><span class="co">#提议分布的标准差</span></span>
<span id="cb106-44"><a href="#cb106-44" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">11000</span><span class="co">#链的长度</span></span>
<span id="cb106-45"><a href="#cb106-45" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#预烧期值</span></span>
<span id="cb106-46"><a href="#cb106-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-47"><a href="#cb106-47" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">cauchy.chain</span>(sigma,n,<span class="dv">0</span>)</span>
<span id="cb106-48"><a href="#cb106-48" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span>X[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#实验生成的随机数与真实Cauchy分布分位数的比较</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fl">0.1</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;generated observations&quot;</span>,<span class="fu">round</span>(<span class="fu">quantile</span>(X,a),<span class="dv">4</span>)),<span class="fu">c</span>(<span class="st">&quot;standard Cauchy distribution&quot;</span>,<span class="fu">round</span>(<span class="fu">qcauchy</span>(a),<span class="dv">4</span>))))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="29%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">10%</th>
<th align="left">20%</th>
<th align="left">30%</th>
<th align="left">40%</th>
<th align="left">50%</th>
<th align="left">60%</th>
<th align="left">70%</th>
<th align="left">80%</th>
<th align="left">90%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">generated observations</td>
<td align="left">-2.6134</td>
<td align="left">-1.2886</td>
<td align="left">-0.6883</td>
<td align="left">-0.3267</td>
<td align="left">-0.0206</td>
<td align="left">0.2944</td>
<td align="left">0.6331</td>
<td align="left">1.1334</td>
<td align="left">2.1907</td>
</tr>
<tr class="even">
<td align="left">standard Cauchy distribution</td>
<td align="left">-3.0777</td>
<td align="left">-1.3764</td>
<td align="left">-0.7265</td>
<td align="left">-0.3249</td>
<td align="left">0</td>
<td align="left">0.3249</td>
<td align="left">0.7265</td>
<td align="left">1.3764</td>
<td align="left">3.0777</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">quantile</span>(X,a),<span class="fu">qcauchy</span>(a),<span class="at">type=</span><span class="st">&quot;p&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;generated observations&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;standard Cauchy distribution&quot;</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从上述结果可以看出，生成的随机数的20%和80%分位数的结果与真实标准柯西分布的分位数较为相近。</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">1</span><span class="co">#提议分布的标准差</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">4</span><span class="co">#生成的马尔可夫链数目</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20000</span><span class="co">#链的长度</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#预烧期值</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co">#生成链</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>k,<span class="at">ncol=</span>n<span class="sc">-</span>b)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  X[i,]<span class="ot">&lt;-</span><span class="fu">cauchy.chain</span>(sigma,n,<span class="dv">0</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>b)]<span class="co">#去掉前1000个迭代值</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>psi<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(X,<span class="dv">1</span>,cumsum))</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) {</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  psi[i,]<span class="ot">&lt;-</span>psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>rhat<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n<span class="sc">-</span>b)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">5000</span><span class="sc">:</span>(n<span class="sc">-</span>b)){</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>  rhat[j]<span class="ot">&lt;-</span><span class="fu">gelman.rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])<span class="co">#从链长度为5000时开始计算</span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>rhat<span class="ot">&lt;-</span>rhat[<span class="dv">5000</span><span class="sc">:</span>(n<span class="sc">-</span>b)]</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">5000</span><span class="sc">:</span>(n<span class="sc">-</span>b),rhat,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(rhat<span class="sc">&lt;=</span><span class="fl">1.2</span>)[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">5000</span></span></code></pre></div>
<pre><code>## [1] 10576</code></pre>
<p>从上述实验结果，在去掉链的前1000个迭代之后，大约在16000以后<span class="math inline">\(\hat{R}&lt;1.2\)</span>。</p>
<p>若是改变实验中提议分布的标准差：</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">3</span><span class="co">#提议分布的标准差</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">4</span><span class="co">#生成的马尔可夫链数目</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20000</span><span class="co">#链的长度</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#预烧期值</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co">#生成链</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>k,<span class="at">ncol=</span>n<span class="sc">-</span>b)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  X[i,]<span class="ot">&lt;-</span><span class="fu">cauchy.chain</span>(sigma,n,<span class="dv">0</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>b)]<span class="co">#去掉前1000个迭代值</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>psi<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(X,<span class="dv">1</span>,cumsum))</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) {</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>  psi[i,]<span class="ot">&lt;-</span>psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>rhat<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n<span class="sc">-</span>b)</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">5000</span><span class="sc">:</span>(n<span class="sc">-</span>b)){</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>  rhat[j]<span class="ot">&lt;-</span><span class="fu">gelman.rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])<span class="co">#从链长度为5000时开始计算</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>rhat<span class="ot">&lt;-</span>rhat[<span class="dv">5000</span><span class="sc">:</span>(n<span class="sc">-</span>b)]</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">5000</span><span class="sc">:</span>(n<span class="sc">-</span>b),rhat,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(rhat<span class="sc">&lt;=</span><span class="fl">1.2</span>)[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">5000</span></span></code></pre></div>
<pre><code>## [1] 13173</code></pre>
<p>从上述实验结果，在去掉链的前1000个迭代之后，大约在13173以后<span class="math inline">\(\hat{R}&lt;1.2\)</span>。</p>
</div>
<div id="section-21" class="section level3">
<h3>9.8</h3>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span><span class="co">#链的长度</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#预烧期值</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co">#生成二元的马尔可夫链</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>chain<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b,N,X1){</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#sigma为提议分布的标准差</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#N为链的长度</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#初始值为X1</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)<span class="co">#马尔可夫链</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">&lt;-</span>X1</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span>X[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,<span class="at">prob =</span> y)</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,<span class="at">shape1=</span>x<span class="sc">+</span>a,<span class="at">shape2=</span>n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,])</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>参数<span class="math inline">\(n=19\)</span>:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">19</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co">#更改初始值</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">c</span>(x1,y1)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">c</span>(x2,y2)</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>y3<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>X3<span class="ot">&lt;-</span><span class="fu">c</span>(x3,y3)</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="co">#生成三个初始值不同的马尔可夫链</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="fu">chain</span>(n,a,b,N,X1),<span class="fu">chain</span>(n,a,b,N,X2),<span class="fu">chain</span>(n,a,b,N,X3))</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Gelman-Rubin诊断</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>mcmc<span class="ot">&lt;-</span><span class="fu">mcmc.list</span>(<span class="fu">mcmc</span>(X[[<span class="dv">1</span>]]),<span class="fu">mcmc</span>(X[[<span class="dv">2</span>]]),<span class="fu">mcmc</span>(X[[<span class="dv">3</span>]]))</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mcmc,<span class="at">transform =</span> T)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1       1.01
## [2,]          1       1.02
## 
## Multivariate psrf
## 
## 1.01</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.plot</span>(mcmc,<span class="at">transform =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看出大概在1000以内<span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<p>更改参数<span class="math inline">\(n=5\)</span>：</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co">#更改初始值</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">c</span>(x1,y1)</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">c</span>(x2,y2)</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>y3<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>X3<span class="ot">&lt;-</span><span class="fu">c</span>(x3,y3)</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="co">#生成三个初始值不同的马尔可夫链</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="fu">chain</span>(n,a,b,N,X1),<span class="fu">chain</span>(n,a,b,N,X2),<span class="fu">chain</span>(n,a,b,N,X3))</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Gelman-Rubin诊断</span></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>mcmc<span class="ot">&lt;-</span><span class="fu">mcmc.list</span>(<span class="fu">mcmc</span>(X[[<span class="dv">1</span>]]),<span class="fu">mcmc</span>(X[[<span class="dv">2</span>]]),<span class="fu">mcmc</span>(X[[<span class="dv">3</span>]]))</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mcmc,<span class="at">transform =</span> T)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1
## [2,]          1          1
## 
## Multivariate psrf
## 
## 1</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.plot</span>(mcmc,<span class="at">transform =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>当<span class="math inline">\(n\)</span>从19变到5时，收敛变快了。<span class="math inline">\(n=5\)</span>时，初始的<span class="math inline">\(\hat{R}&lt;1.2\)</span>。</p>
</div>
</div>
</div>
<div id="section-22" class="section level1">
<h1>2021-11-18</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)</p>
<p>Suppose <span class="math inline">\(T_1,\cdots,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i\le\tau)+\tau I(T_i&gt;\tau),\ i=1,\cdots,n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: 0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85 Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="section-23" class="section level3">
<h3>11.3</h3>
<ol style="list-style-type: lower-alpha">
<li><span class="math display">\[\begin{equation*}
\frac{(-1)^k}{k!2^k}\frac{\Vert a\Vert^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}=(-1)^k exp\{-\ln k!-k\ln 2+(k+1)\ln \Vert a\Vert^{2}-\ln (2k+1)-\ln (2k+2)+\ln \Gamma(\frac{d+1}{2})+\ln \Gamma(k+\frac{3}{2})-\ln\Gamma(k+\frac{d}{2}+1)\}.
\end{equation*}\]</span></li>
</ol>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#计算第k项的值</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>k.term<span class="ot">&lt;-</span><span class="cf">function</span>(k,a,d){</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#k&gt;=0,d&gt;0整数，a是一个d维向量</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="fu">factorial</span>(k)) <span class="sc">-</span> k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">+</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(k<span class="fl">+1.5</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k<span class="sc">+</span>(d<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#计算求和</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>k.sum<span class="ot">&lt;-</span><span class="cf">function</span>(a,d){</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#d&gt;0整数，a是一个d维向量</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  kterm<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k<span class="sc">&lt;=</span><span class="dv">1000</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(kterm)<span class="sc">&gt;</span><span class="fl">10e-10</span>) {<span class="co">#当迭代次数超过1000或者单项绝对值小于10e-10停止</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    kterm<span class="ot">&lt;-</span><span class="fu">k.term</span>(k,a,d)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>    s<span class="ot">&lt;-</span>s<span class="sc">+</span>kterm</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">k.sum</span>(a,d)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
</div>
<div id="section-24" class="section level3">
<h3>11.5</h3>
<p><span class="math display">\[\begin{equation*}
\frac{\Gamma(\frac{k+1}{2})}{\sqrt{\pi k}\Gamma(\frac{k-1}{2})}=exp\{\ln \Gamma(\frac{k+1}{2})-\ln\sqrt{\pi k}-\ln \Gamma(\frac{k-1}{2}) \}
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#积分函数</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>int<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  ck<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">*</span>a<span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">*</span>a))</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">integrate</span>(<span class="cf">function</span>(u) {(<span class="dv">1</span><span class="sc">+</span>u<span class="sc">*</span>u<span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)},<span class="at">lower =</span> <span class="dv">0</span>,<span class="at">upper =</span> ck)<span class="sc">$</span>value</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>Sk<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){<span class="co">#计算</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span>k))<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">int</span>(a,k)</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.1</span>)</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol =</span> <span class="fu">length</span>(a))</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a)) {</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span>,i]<span class="ot">&lt;-</span><span class="fu">Sk</span>(a[i],k[<span class="dv">22</span>])<span class="sc">-</span><span class="fu">Sk</span>(a[i],k[<span class="dv">22</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">2</span>,i]<span class="ot">&lt;-</span><span class="fu">Sk</span>(a[i],k[<span class="dv">23</span>])<span class="sc">-</span><span class="fu">Sk</span>(a[i],k[<span class="dv">23</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">3</span>,i]<span class="ot">&lt;-</span><span class="fu">Sk</span>(a[i],k[<span class="dv">24</span>])<span class="sc">-</span><span class="fu">Sk</span>(a[i],k[<span class="dv">24</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">4</span>,i]<span class="ot">&lt;-</span><span class="fu">Sk</span>(a[i],k[<span class="dv">25</span>])<span class="sc">-</span><span class="fu">Sk</span>(a[i],k[<span class="dv">25</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="co">#通过图来判断根所在的区间</span></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,y[<span class="dv">1</span>,],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;S_x-S_{k-1}&quot;</span>,<span class="at">main =</span> <span class="st">&quot;k=25&quot;</span>)</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,y[<span class="dv">2</span>,],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;S_x-S_{k-1}&quot;</span>,<span class="at">main =</span> <span class="st">&quot;k=100&quot;</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,y[<span class="dv">3</span>,],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;S_x-S_{k-1}&quot;</span>,<span class="at">main =</span> <span class="st">&quot;k=500&quot;</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,y[<span class="dv">4</span>,],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;S_x-S_{k-1}&quot;</span>,<span class="at">main =</span> <span class="st">&quot;k=1000&quot;</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>由上图可以看出函数曲线在区间[1,2]间有交点。</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>Ak<span class="ot">&lt;-</span><span class="cf">function</span>(k){</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uniroot</span>(<span class="cf">function</span>(a) {<span class="fu">Sk</span>(a,k)<span class="sc">-</span><span class="fu">Sk</span>(a,k<span class="dv">-1</span>)},<span class="at">interval=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>root1<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(k))</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)) {</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>  root1[i]<span class="ot">&lt;-</span><span class="fu">Ak</span>(k[i])</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,k),<span class="fu">c</span>(<span class="st">&quot;root&quot;</span>,<span class="fu">round</span>(root1,<span class="dv">3</span>))))</span></code></pre></div>
<table>
<colgroup>
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">k</td>
<td align="left">4</td>
<td align="left">5</td>
<td align="left">6</td>
<td align="left">7</td>
<td align="left">8</td>
<td align="left">9</td>
<td align="left">10</td>
<td align="left">11</td>
<td align="left">12</td>
<td align="left">13</td>
<td align="left">14</td>
<td align="left">15</td>
<td align="left">16</td>
<td align="left">17</td>
<td align="left">18</td>
<td align="left">19</td>
<td align="left">20</td>
<td align="left">21</td>
<td align="left">22</td>
<td align="left">23</td>
<td align="left">24</td>
<td align="left">25</td>
<td align="left">100</td>
<td align="left">500</td>
<td align="left">1000</td>
</tr>
<tr class="even">
<td align="left">root</td>
<td align="left">1.492</td>
<td align="left">1.534</td>
<td align="left">1.563</td>
<td align="left">1.584</td>
<td align="left">1.601</td>
<td align="left">1.615</td>
<td align="left">1.625</td>
<td align="left">1.634</td>
<td align="left">1.642</td>
<td align="left">1.649</td>
<td align="left">1.654</td>
<td align="left">1.659</td>
<td align="left">1.663</td>
<td align="left">1.667</td>
<td align="left">1.671</td>
<td align="left">1.674</td>
<td align="left">1.677</td>
<td align="left">1.679</td>
<td align="left">1.681</td>
<td align="left">1.684</td>
<td align="left">1.686</td>
<td align="left">1.687</td>
<td align="left">1.721</td>
<td align="left">1.73</td>
<td align="left">1.731</td>
</tr>
</tbody>
</table>
<p>11.4题</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>Sk<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  critical<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">*</span>a<span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">*</span>a))</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(critical,<span class="at">df=</span>k)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.1</span>)</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co">#通过图来判断根所在的区间</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,<span class="fu">Sk</span>(a,k[<span class="dv">22</span>])<span class="sc">-</span><span class="fu">Sk</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.1</span>),k[<span class="dv">22</span>]<span class="sc">-</span><span class="dv">1</span>),<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;S_x-S_{k-1}&quot;</span>,<span class="at">main =</span> <span class="st">&quot;k=25&quot;</span>)</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,<span class="fu">Sk</span>(a,k[<span class="dv">23</span>])<span class="sc">-</span><span class="fu">Sk</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.1</span>),k[<span class="dv">23</span>]<span class="sc">-</span><span class="dv">1</span>),<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;S_x-S_{k-1}&quot;</span>,<span class="at">main =</span> <span class="st">&quot;k=100&quot;</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,<span class="fu">Sk</span>(a,k[<span class="dv">24</span>])<span class="sc">-</span><span class="fu">Sk</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.1</span>),k[<span class="dv">24</span>]<span class="sc">-</span><span class="dv">1</span>),<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;S_x-S_{k-1}&quot;</span>,<span class="at">main =</span> <span class="st">&quot;k=500&quot;</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,<span class="fu">Sk</span>(a,k[<span class="dv">25</span>])<span class="sc">-</span><span class="fu">Sk</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.1</span>),k[<span class="dv">25</span>]<span class="sc">-</span><span class="dv">1</span>),<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;S_x-S_{k-1}&quot;</span>,<span class="at">main =</span> <span class="st">&quot;k=1000&quot;</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>由上图可以看出函数曲线在区间[1,2]间有交点。</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>Ak<span class="ot">&lt;-</span><span class="cf">function</span>(k){<span class="co">#求解A(k)</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uniroot</span>(<span class="cf">function</span>(a) {<span class="fu">Sk</span>(a,k)<span class="sc">-</span><span class="fu">Sk</span>(a,k<span class="dv">-1</span>)},<span class="at">interval=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>root2<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(k))</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)) {</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  root2[i]<span class="ot">&lt;-</span><span class="fu">Ak</span>(k[i])</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,k),<span class="fu">c</span>(<span class="st">&quot;root&quot;</span>,<span class="fu">round</span>(root2,<span class="dv">3</span>))))</span></code></pre></div>
<table>
<colgroup>
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">k</td>
<td align="left">4</td>
<td align="left">5</td>
<td align="left">6</td>
<td align="left">7</td>
<td align="left">8</td>
<td align="left">9</td>
<td align="left">10</td>
<td align="left">11</td>
<td align="left">12</td>
<td align="left">13</td>
<td align="left">14</td>
<td align="left">15</td>
<td align="left">16</td>
<td align="left">17</td>
<td align="left">18</td>
<td align="left">19</td>
<td align="left">20</td>
<td align="left">21</td>
<td align="left">22</td>
<td align="left">23</td>
<td align="left">24</td>
<td align="left">25</td>
<td align="left">100</td>
<td align="left">500</td>
<td align="left">1000</td>
</tr>
<tr class="even">
<td align="left">root</td>
<td align="left">1.492</td>
<td align="left">1.534</td>
<td align="left">1.563</td>
<td align="left">1.584</td>
<td align="left">1.601</td>
<td align="left">1.615</td>
<td align="left">1.625</td>
<td align="left">1.634</td>
<td align="left">1.642</td>
<td align="left">1.649</td>
<td align="left">1.654</td>
<td align="left">1.659</td>
<td align="left">1.663</td>
<td align="left">1.667</td>
<td align="left">1.671</td>
<td align="left">1.674</td>
<td align="left">1.677</td>
<td align="left">1.679</td>
<td align="left">1.681</td>
<td align="left">1.684</td>
<td align="left">1.686</td>
<td align="left">1.687</td>
<td align="left">1.721</td>
<td align="left">1.73</td>
<td align="left">1.731</td>
</tr>
</tbody>
</table>
<p>将11.5的结果与11.4的结果比较有</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,k),<span class="fu">c</span>(<span class="st">&quot;11.4&quot;</span>,<span class="fu">round</span>(root2,<span class="dv">3</span>)),<span class="fu">c</span>(<span class="st">&quot;11.5&quot;</span>,<span class="fu">round</span>(root1,<span class="dv">3</span>)),<span class="fu">c</span>(<span class="st">&quot;差&quot;</span>,<span class="fu">round</span>(root1<span class="sc">-</span>root2,<span class="dv">3</span>))))</span></code></pre></div>
<table>
<colgroup>
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">k</td>
<td align="left">4</td>
<td align="left">5</td>
<td align="left">6</td>
<td align="left">7</td>
<td align="left">8</td>
<td align="left">9</td>
<td align="left">10</td>
<td align="left">11</td>
<td align="left">12</td>
<td align="left">13</td>
<td align="left">14</td>
<td align="left">15</td>
<td align="left">16</td>
<td align="left">17</td>
<td align="left">18</td>
<td align="left">19</td>
<td align="left">20</td>
<td align="left">21</td>
<td align="left">22</td>
<td align="left">23</td>
<td align="left">24</td>
<td align="left">25</td>
<td align="left">100</td>
<td align="left">500</td>
<td align="left">1000</td>
</tr>
<tr class="even">
<td align="left">11.4</td>
<td align="left">1.492</td>
<td align="left">1.534</td>
<td align="left">1.563</td>
<td align="left">1.584</td>
<td align="left">1.601</td>
<td align="left">1.615</td>
<td align="left">1.625</td>
<td align="left">1.634</td>
<td align="left">1.642</td>
<td align="left">1.649</td>
<td align="left">1.654</td>
<td align="left">1.659</td>
<td align="left">1.663</td>
<td align="left">1.667</td>
<td align="left">1.671</td>
<td align="left">1.674</td>
<td align="left">1.677</td>
<td align="left">1.679</td>
<td align="left">1.681</td>
<td align="left">1.684</td>
<td align="left">1.686</td>
<td align="left">1.687</td>
<td align="left">1.721</td>
<td align="left">1.73</td>
<td align="left">1.731</td>
</tr>
<tr class="odd">
<td align="left">11.5</td>
<td align="left">1.492</td>
<td align="left">1.534</td>
<td align="left">1.563</td>
<td align="left">1.584</td>
<td align="left">1.601</td>
<td align="left">1.615</td>
<td align="left">1.625</td>
<td align="left">1.634</td>
<td align="left">1.642</td>
<td align="left">1.649</td>
<td align="left">1.654</td>
<td align="left">1.659</td>
<td align="left">1.663</td>
<td align="left">1.667</td>
<td align="left">1.671</td>
<td align="left">1.674</td>
<td align="left">1.677</td>
<td align="left">1.679</td>
<td align="left">1.681</td>
<td align="left">1.684</td>
<td align="left">1.686</td>
<td align="left">1.687</td>
<td align="left">1.721</td>
<td align="left">1.73</td>
<td align="left">1.731</td>
</tr>
<tr class="even">
<td align="left">差</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>两题结果一致。</p>
</div>
<div id="section-25" class="section level3">
<h3>3</h3>
<p>Suppose <span class="math inline">\(T_1,\cdots,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i\le\tau)+\tau I(T_i&gt;\tau),\ i=1,\cdots,n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: 0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85 Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
<p>MLE求解：</p>
<p>令<span class="math inline">\(y=(y_1,\cdots,y_{10})=(0.54, 0.48, 0.33, 0.43, 0.91, 0.21, 0.85, 1.00, 1.00, 1.00)\)</span>。而<span class="math inline">\(Y_i\)</span>的密度函数为 <span class="math display">\[\begin{equation*}
\left\{
\begin{array}{lr}
f(y)=\frac{1}{\lambda}e^{-y/\lambda},y\le 1\\
P(Y=1)=e^{-1/\lambda}\\
\end{array}
\right.
\end{equation*}\]</span> 则联合密度函数为 <span class="math display">\[\begin{equation*}
f(y)=\frac{1}{\lambda^7}e^{-\sum_{i=1}^{7}y_i/\lambda}e^{-3/\lambda}.
\end{equation*}\]</span> 求解对数似然函数有</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">0.91</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>l<span class="ot">&lt;-</span><span class="cf">function</span>(lambda){<span class="co">#似然函数</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">7</span><span class="sc">*</span><span class="fu">log</span>(lambda)<span class="sc">-</span><span class="fu">sum</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>])<span class="sc">/</span>lambda<span class="dv">-3</span><span class="sc">/</span>lambda</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize</span>(l,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">3</span>),<span class="at">maximum =</span> T)<span class="sc">$</span>maximum</span></code></pre></div>
<pre><code>## [1] 0.9642801</code></pre>
<p>即<span class="math inline">\(\hat{\lambda}=1.393\)</span>。</p>
<p>EM算法：</p>
<p>令完全数据为<span class="math inline">\(X=(T_1,\cdots,T_{10},Y_1,\cdots,Y_{10})\)</span>，则此时的似然函数为 <span class="math display">\[\begin{equation*}
\pi(\lambda|X)=\frac{1}{\lambda^7}e{-\frac{\sum_{i=1}^{10}t_i}{\lambda}}
\end{equation*}\]</span> E-M算法中的E步： <span class="math display">\[\begin{equation*}
Q(\lambda,\hat{\lambda}^{(i)})=E[-7\ln\lambda-\frac{\sum_{i=1}^{10}t_i}{\lambda}|X,\hat{\lambda}^{(i)}]=-7\ln\lambda-\sum_{i=1}^{7}y_i/\lambda-3E[t_i|X,\hat{\lambda}^{(i)}]/\lambda
\end{equation*}\]</span> 其中<span class="math inline">\(E[t_i|X,\hat{\lambda}^{(i)}]=1+\hat{\lambda}^{(i)}\)</span>，从而 <span class="math display">\[\begin{equation*}
Q(\lambda,\hat{\lambda}^{(i)})=-7\ln\lambda-\sum_{i=1}^{7}y_i/\lambda-3(1+\hat{\lambda}^{(i)})/\lambda
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#E-M算法</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>EM<span class="ot">&lt;-</span><span class="cf">function</span>(y,<span class="at">max.it=</span><span class="dv">10000</span>,<span class="at">eps=</span><span class="fl">1e-5</span>){</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  lambda1<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  lambda2<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(lambda1<span class="sc">-</span>lambda2)<span class="sc">&gt;</span>eps <span class="sc">&amp;</span> i<span class="sc">&lt;</span>max.it) {</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>    lambda1<span class="ot">&lt;-</span>lambda2</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>    Q<span class="ot">&lt;-</span><span class="cf">function</span>(lambda){<span class="co">#E步</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="dv">7</span><span class="sc">*</span><span class="fu">log</span>(lambda)<span class="sc">-</span><span class="fu">sum</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>])<span class="sc">/</span>lambda<span class="dv">-3</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>lambda1)<span class="sc">/</span>lambda</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>    lambda2<span class="ot">&lt;-</span><span class="fu">optimize</span>(Q,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">3</span>),<span class="at">maximum =</span> T)<span class="sc">$</span>maximum<span class="co">#M步</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lambda2)</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">0.91</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>)</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a><span class="fu">EM</span>(y)</span></code></pre></div>
<pre><code>## [1] 1.687472</code></pre>
<p>E-M算法得到的估计值比MLE略大。</p>
</div>
</div>
</div>
<div id="section-26" class="section level1">
<h1>2021-11-25</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>Exercises 1 and 5 (page 204, Advanced R) Excecises 1 and 7 (page 214, Advanced R)</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="exercises-1-page-204-advanced-r" class="section level3">
<h3>Exercises 1 (page 204, Advanced R)</h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] -1.287194
## 
## [[2]]
## [1] -0.25283
## 
## [[3]]
## [1] -0.1897854
## 
## [[4]]
## [1] -0.1868222</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] -1.287194
## 
## [[2]]
## [1] -0.25283
## 
## [[3]]
## [1] -0.1897854
## 
## [[4]]
## [1] -0.1868222</code></pre>
<p>通过实验可以发现lapply()函数的两种调用可以得到相同的结果。</p>
<p>原因：调用lapply()函数的帮助文档可以看到lapply(X, FUN, …)，其中X是一个向量或者列表，即lapply()作用的对象，FUN则是施加于X的每一个元素的d函数，而…则是FUN的可选参数。对于第一种调用方式，lapply函数作用与trims，使用的函数为mean(x,trim=trim)，trims中的每一个元素作为mean函数的参数trim，x是预先生成的随机数。对于第二种调用方式，可以通过mean函数的帮助文档也可以看出mean(x, trim = 0, na.rm = FALSE, …)，其中x适用于求平均数的样本数据，trim则是从x中剔除数据的比例，故在对trims使用lapply时，FUN是mean函数，而…是“x=x”也即FUN的可选参数也即选定了求取平均数的样本，从而trims中的元素就作为mean函数中的trim参数使用，故两种调用方法的结果是一样的。</p>
</div>
<div id="exercises-5-page-204-advanced-r" class="section level3">
<h3>Exercises 5 (page 204, Advanced R)</h3>
<p>Exercises 3:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(formulas,<span class="cf">function</span>(x){</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">&lt;-</span><span class="fu">lm</span>(x,<span class="at">data =</span> mtcars)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rsq</span>(mod)</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<p>Exercises 4:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(bootstraps,<span class="cf">function</span>(x){</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">&lt;-</span><span class="fu">lm</span>(mpg <span class="sc">~</span> disp,<span class="at">data=</span>x)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rsq</span>(mod)</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6083954
## 
## [[2]]
## [1] 0.6255956
## 
## [[3]]
## [1] 0.7603951
## 
## [[4]]
## [1] 0.7243168
## 
## [[5]]
## [1] 0.8202593
## 
## [[6]]
## [1] 0.7149485
## 
## [[7]]
## [1] 0.8096765
## 
## [[8]]
## [1] 0.6962249
## 
## [[9]]
## [1] 0.6783824
## 
## [[10]]
## [1] 0.8181409</code></pre>
</div>
<div id="exercises-1-page-214-advanced-r" class="section level3">
<h3>Exercises 1 (page 214, Advanced R)</h3>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">20</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x1,x2,x3)<span class="co">#生成一个全是数据的dataframe</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(x,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))<span class="co">#求解dataframe每一列数据的标准差</span></span></code></pre></div>
<pre><code>##        x1        x2        x3 
## 5.9160798 0.9029419 0.0000000</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">sd</span>(x1),<span class="fu">sd</span>(x2),<span class="fu">sd</span>(x3)))<span class="co">#验证结果正确</span></span></code></pre></div>
<pre><code>## [1] 5.9160798 0.9029419 0.0000000</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>x4<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>,<span class="st">&quot;5&quot;</span>)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x1,x2,x3,x4)<span class="co">#生成一个混合的dataframe</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">vapply</span>(x,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))<span class="co">#判断全是数据的列</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(x[y],sd,<span class="fu">numeric</span>(<span class="dv">1</span>))<span class="co">#求数据列的标准差</span></span></code></pre></div>
<pre><code>##       x1       x3 
## 1.227128 0.000000</code></pre>
</div>
<div id="exercises-7-page-214-advanced-r" class="section level3">
<h3>Exercises 7 (page 214, Advanced R)</h3>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>cores<span class="ot">&lt;-</span><span class="fu">detectCores</span>()</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>cores</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>cluster<span class="ot">&lt;-</span><span class="fu">makePSOCKcluster</span>(cores)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>boot_rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> disp, <span class="at">data =</span> mtcars[<span class="fu">sample</span>(<span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> T), ]))<span class="sc">$</span>r.square</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>mcsapply<span class="ot">&lt;-</span><span class="cf">function</span>(x,f,...){</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>  res<span class="ot">&lt;-</span><span class="fu">parLapply</span>(cluster,x,f,...)</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simplify2array</span>(res)</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a><span class="co">#简单检测正确性</span></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,sqrt)</span></code></pre></div>
<pre><code>##  [1] 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751 2.828427
##  [9] 3.000000 3.162278</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcsapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,sqrt)</span></code></pre></div>
<pre><code>##  [1] 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751 2.828427
##  [9] 3.000000 3.162278</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parSapply</span>(cluster,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,sqrt)</span></code></pre></div>
<pre><code>##  [1] 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751 2.828427
##  [9] 3.000000 3.162278</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#比较运行时间</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>,boot_rsq))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.48 0.00 0.48</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">mcsapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>,boot_rsq))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.02 0.26</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">parSapply</span>(cluster,<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>,boot_rsq))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.01 0.00 0.22</code></pre>
<p>可以看出编写的mcsapply函数与sapply函数有相同的运行结果，但是计算效率大大提升。</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>vapply2<span class="ot">&lt;-</span><span class="cf">function</span>(x,f,f.value,...){</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rep</span>(f.value,<span class="fu">length</span>(x)),<span class="at">nrow=</span><span class="fu">length</span>(x))</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">sample</span>(<span class="fu">seq_along</span>(x))) {<span class="co">#打乱计算顺序</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>    res<span class="ot">&lt;-</span><span class="fu">f</span>(<span class="fu">unlist</span>(x[i]),...)</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>(res)<span class="sc">==</span><span class="fu">length</span>(f.value),</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">typeof</span>(res)<span class="sc">==</span><span class="fu">typeof</span>(f.value)</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>    out[i,]<span class="ot">&lt;-</span>res</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">20</span>)</span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x1,x2,x3)<span class="co">#生成一个全是数据的dataframe</span></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(x,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))<span class="co">#求解dataframe每一列数据的标准差</span></span></code></pre></div>
<pre><code>##       x1       x2       x3 
## 5.916080 0.823764 0.000000</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply2</span>(x,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 5.916080
## [2,] 0.823764
## [3,] 0.000000</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>x4<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>,<span class="st">&quot;5&quot;</span>)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x1,x2,x3,x4)<span class="co">#生成一个混合的dataframe</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(x,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))<span class="co">#判断全是数据的列</span></span></code></pre></div>
<pre><code>##    x1    x2    x3    x4 
##  TRUE FALSE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply2</span>(x,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##       [,1]
## [1,]  TRUE
## [2,] FALSE
## [3,]  TRUE
## [4,] FALSE</code></pre>
<p>因为vapply在计算时每次都是独立的，故可以打乱顺序进行计算，因此mcvapply是可以实现的。</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>cores<span class="ot">&lt;-</span><span class="fu">detectCores</span>()</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>cores</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>cluster<span class="ot">&lt;-</span><span class="fu">makePSOCKcluster</span>(cores)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>mcvapply<span class="ot">&lt;-</span><span class="cf">function</span>(x,f,f.value,...){</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>  res<span class="ot">&lt;-</span><span class="fu">mcsapply</span>(x,f,...)</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">sample</span>(<span class="fu">seq_along</span>(x)))</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>(res[i])<span class="sc">==</span><span class="fu">length</span>(f.value),</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">typeof</span>(res[i])<span class="sc">==</span><span class="fu">typeof</span>(f.value)</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>  res</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">20</span>)</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x1,x2,x3)<span class="co">#生成一个全是数据的dataframe</span></span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mcvapply</span>(x,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))<span class="co">#求解dataframe每一列数据的标准差</span></span></code></pre></div>
<pre><code>##       x1       x2       x3 
## 5.916080 1.138176 0.000000</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>x4<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>,<span class="st">&quot;5&quot;</span>)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x1,x2,x3,x4)<span class="co">#生成一个混合的dataframe</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mcvapply</span>(x,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))<span class="co">#判断全是数据的列</span></span></code></pre></div>
<pre><code>##    x1    x2    x3    x4 
##  TRUE FALSE  TRUE FALSE</code></pre>
</div>
</div>
</div>
<div id="section-27" class="section level1">
<h1>2021-12-02</h1>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>1.Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).</p>
<p>2.Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p>
<p>3.Campare the computation time of the two functions with the function “microbenchmark”.</p>
<p>4.Comments your results.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="section-28" class="section level3">
<h3>1</h3>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="do">##Gibbs抽样的Cpp函数</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix gibbsC(int n, double a, double b, int N, double x1, double y1) {</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix X(N,2);</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="st">  X(0,0)=x1;</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="st">  X(0,1)=y1;</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a><span class="st">  int i;</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a><span class="st">  double x;</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a><span class="st">  double y;</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a><span class="st">  for(i=1;i&lt;N;i++){</span></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a><span class="st">    y=X(i-1,1);</span></span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a><span class="st">    X(i,0)=rbinom(1,n,y)[0];</span></span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a><span class="st">    x=X(i,0);</span></span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a><span class="st">    X(i,1)=rbeta(1,x+a,n-x+b)[0];</span></span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a><span class="st">  return(X);</span></span>
<span id="cb184-19"><a href="#cb184-19" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span>
<span id="cb184-20"><a href="#cb184-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-21"><a href="#cb184-21" aria-hidden="true" tabindex="-1"></a><span class="do">##Gibbs抽样的R函数</span></span>
<span id="cb184-22"><a href="#cb184-22" aria-hidden="true" tabindex="-1"></a>gibbsR<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b,N,x1,y1){</span>
<span id="cb184-23"><a href="#cb184-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb184-24"><a href="#cb184-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#sigma为提议分布的标准差</span></span>
<span id="cb184-25"><a href="#cb184-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#N为链的长度</span></span>
<span id="cb184-26"><a href="#cb184-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#初始值为X1</span></span>
<span id="cb184-27"><a href="#cb184-27" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)<span class="co">#马尔可夫链</span></span>
<span id="cb184-28"><a href="#cb184-28" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(x1,y1)</span>
<span id="cb184-29"><a href="#cb184-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb184-30"><a href="#cb184-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb184-31"><a href="#cb184-31" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb184-32"><a href="#cb184-32" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span>X[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,<span class="at">prob =</span> y)</span>
<span id="cb184-33"><a href="#cb184-33" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,<span class="at">shape1=</span>x<span class="sc">+</span>a,<span class="at">shape2=</span>n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb184-34"><a href="#cb184-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb184-35"><a href="#cb184-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb184-36"><a href="#cb184-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section-29" class="section level3">
<h3>2-3</h3>
<p>令<span class="math inline">\(n=10,\ a=2,\ b=3,\ N=1000\)</span>，初始值为<span class="math inline">\((2,0.5)\)</span>，去掉链的前500个值。</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">#通过qq图比较两种语言写的函数生成的随机数</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">gibbsC</span>(<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="fl">0.5</span>)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>),]</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">gibbsR</span>(<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="fl">0.5</span>)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>),]</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X[,<span class="dv">1</span>],Y[,<span class="dv">1</span>],<span class="at">xlab =</span> <span class="st">&quot;x of Cpp&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;x of R&quot;</span>)</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X[,<span class="dv">2</span>],Y[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;y of Cpp&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y of R&quot;</span>)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6Ojo6OpA6kNtmAABmADpmkJBmtv+QOgCQZgCQtpCQ27aQ2/+2ZgC2/7a2///bkDrbkJDb////tmb/trb/25D//7b//9v///9YY1R0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAInUlEQVR4nO2di5abNhRFmTTxpHE6bhs3tNQ2//+XASRjZAkfSUjiYp+d1SzPREh49+qFL7hqyUOqtU9AOhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCJBYULUZ1hKUtroMaDcUNEM1+c/7gMTty+XasyoKctJ7ufYvCrJRPUv3LwqyUcEzyOEs5kKPP1WVMYKOVfXlcuja+EhSXWGuvSvfLFZ//q9z9KVtz/tvCaorzbA+vE1kngcFNHA5dFqatx+tUrW0utJM9GQSdN53Pav59LO9/r2sumKorUXVtpPBmRF0o1J/9PQ1/tL76ADGMWhQtbi6Muj4URvUzIK2OIsZfm7nx3WQppr+mSwPKUgzuQBkLJ9zC6q3MYuZ/cv4F+8q0p1I0IW6/IxR4zyv1+5i1TRy3P/fXlmQOewYk/ukkHdtQW0PU3zHzAgkQZAjelwdP9NCsdLrw6YSulC0P7yYGRjzbTUUIrcalpgHs0a+zapC4mbVip5Hc+rrRVCInTbfGKRDSNoYZI888AjvqoNO5LxXJzATP2sJCoye4RDvuhedWe7qPBsN1vOKgtoQPS8l6H7Z43mUd/Wx51WkOp8Wja6V/n1vXZCpx7/5FxQUoud1BIUsfcwDkxdcpTrYXNjcPj0yvuC/c5cykrabhGg9EYJqfZHncpi91pO03QTEh08bLqj/vPTYbSCaam6Xlbjd5SzREyzochhSNj7qavhgOZ5ygpb5CRU0pLNcDl/7j5UXUUzQQj/hgvrrGMfo7rXwbBe0F9tinKDZqxjp213WymI/kYKWdrBCghL4eWpBKfw8s6AkfsIF3RqVvlBM4udZ92JVmvBpn1VQMj3PKahKFz9PKSipnycUlNZPxDR//r5smxrYbmi9if1EbFYDBJ12c1nAuQSl1hPexWqfdZDHaimLoOR22pgxyCeCdM5C4QjKoCdj8kK/4S8rKIufKEGnXXcK6IrisStQVFAePzGCVP+pZ2/D0NTVt5KCMvmJEHRNH5vLHRs57X4rJ0ibSa0napDWCYhz2Yc3Lof5KEv9NrJEz1BzcEHvCErTrk9dmXqXqjy8oOcYpChwM0tWP/lmsZlaMixUsvrZ/mY1s5/NC8rtJ5egUjezZPeTLZG8yM0sVX4/eQSVuRWhgJ02k6ASN7OUiJ6hneCC5z1M7cgfQVUpP1ER1F80e5zekftmlnJ+YrsYcpT3ZpaCfuLHoPrRJJ6wXcehJf1ECmqq/qkcl0P8fnVBukVJPVGC+u6jzOArHsvbtQ4sqiduFluYvxnW7v1xRe20m9uLFfezKUGle5dqNHnBTNWVnbsm7SYvmKe6tfxsRdBqfrYhaD092xC0pp8NCKpW9SNd0Mp22uKCAt/q2nZa4REkwI9oQRL8CBYkQo9gQUL8iBUkw04rVZAYPTIFSeld6mSSF1xcnSg/4gStv3S+P6HkBRdVJ8xOK0uQuOjpESRIop5sgiISqGT6EZJAdd+55PiRkEBl2xHkZ/0EKslyelaOIEOMRD/ZxiCvBCrp0dOTaRbzSqDagp8110GVzJXhHSsLQk+UX5/cgh7c7fPg61AEsebHPtKDZ2D9MShtvclZTZB4M5rVNqubIYsgvFn1rjNRmVRNpTnaY6vhXedTCvLYrHrX+ZSCGEEIvFn1rvM5BeHNqnedTyooXZ0UVKYMBRVqKtfRLwAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCJBTUTJ/C2LgfyTj99fAZkuPK5P2hju9kMor0z390PBvKKNM/1MbrCZoW6QT1X3LXXE/J+MFd5nLoXtT2W7s/tLGvX5pNdf983j+upu5/iDOUTJC6oq+/Hsj4YaaMeuiylQVxf+h5bwlyNPW4muEL+CK/uiiZIOP9zrx5x6+tMLsvU3/+816Q2dS786E1RhkZgoYTbaZnbX145vj1EZTpfrTGIKNI8+mfvWMoM6uR0MVUKOiAMH6YKaN+Y701s0zfUyxBRpG6TxRQIfKgqZk5w4N1BTXuMfpWpv+AEgh6cwarWU0fp6dd1Dc4rtrFXJ8/2vU87mJqmLEes29W4x4SvVhzkK5dqyCjzPX7UD7miygH1lBtlnEHtBfrTfMzDz+3D7UiyCiiMiqsYHWsKOKeXbfeQnFuTLAOtVfS5iKw++dJWoWzjIQxaOgP/QmpGaV2TxuTMrr72KWMelrnVsMo0rh3LEaZo7uMB9ysAigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEAyYLq8fP0IWM4/psXlyBY0Hl/TTdQiVbHFN8xGIxoQTp/SKePLfn2zniECBoynWqd76LyWfoEep1npsX8/7M9vf+1Gzre+CI3QgQ1Q6qqipg+X7dPnb9G0DSFtbP2MRQYX+RGiKBehs4zVNlizduPq6DbWHRNS+tCanyR+8yECOr7mH63asTp/nYLGrIN336ML3KfmBRBXR87Kg/qrXd2nF3sXeerji9yn5gUQefvf3+/JnfeRdDYkboh53UFXQ5ftQZrDJpO82roOU5e5D4xKYImWeX3s5heKA73l512+raU8UVuxAia5MrrvN7JQ/eGR4P10XLa/bEbEu/HF7mRI+h3n94y3pNh3ZyRCzGCaq9V8csKOu38htuXFSQXCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAT4BTR23y5L2qWGAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="at">gibbsC=</span><span class="fu">gibbsC</span>(<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="fl">0.5</span>),<span class="at">gibbsR=</span><span class="fu">gibbsR</span>(<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1000</span>,<span class="dv">2</span>,<span class="fl">0.5</span>))</span></code></pre></div>
<pre><code>## Unit: microseconds
##    expr      min       lq      mean   median       uq       max neval
##  gibbsC  355.439  364.078  453.0613  372.365  528.222  3587.532   100
##  gibbsR 4030.066 4109.582 5862.6512 4177.812 6813.981 25935.724   100</code></pre>
<p>改变参数，令<span class="math inline">\(n=20,\ a=7,\ b=3,\ N=10000\)</span>，初始值为<span class="math inline">\((10,0.1)\)</span>，去掉链的前500个值。</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">#通过qq图比较两种语言写的函数生成的随机数</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">gibbsC</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">10000</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>),]</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">gibbsR</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">10000</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>),]</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X[,<span class="dv">1</span>],Y[,<span class="dv">1</span>],<span class="at">xlab =</span> <span class="st">&quot;x of Cpp&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;x of R&quot;</span>)</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmOpBmZmZmkJBmtttmtv+QOgCQOmaQtpCQ2/+2ZgC2/7a2///bkDrbkJDb2//b/9vb////tmb/trb/25D//7b//9v////TTcnjAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJO0lEQVR4nO2dDXebNhSGSRp3Tbqt8RYv3lbmmP//Iwf6smyM3yvQF/H7nK7H5/RyhZ+JK0ACNx25SVN6B2qHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgTNBx2yge3xPtTn0ECdo3z/pDaz98fkIEHbdOy/7LzwQ7UyMhgj5eXu3H9m4Ossg9qFkNKQT1Nch0ockaVP+gqNykEtQfZFr/ZAWqXtCwg0pRyAaR268Z7Se/oPBDuxCN90e8RQD7XoEqQ/uJUax6Qep/YTJB+4e3vgw9dWsW1JnjTLxFQHY9zB+3fYlen6Ch73gDWBJB9kRx9+Xn6gQ1V/4TbyjFnSjuntYmSHWdrjH7l64GGS396dDqBDXu77SjmD7Ijtu1CTKFJ7Wg3OmWY8d1e5KWtAblT7eY05mzPYtNOYrlT7cUo6Q7HVpn/yJOEXmP6sEOXhQ0gR28KGgCV5dHhfnuBdl7Gu4Gw8WdhnsX5N8Xu7pPdy7InjaPSs9ZhDhVRKoRpLsPBU0wurIYR4hTxdmjROlm7IA7bb59b+xeBbnifHFlcTVQnDEihQXZS6/pQ8uPFKeMSHlBoDh7keKUMSktyN7cgDtzd4KkxdnFixMv3bOk6YLaFRVnfwNx5ogUEiQvzv4W4tTLKT31LC/O3hbi1DEpJUhcnN0W4tQzdylPOnGzfmEW7cPdCLqYURYvjboXQcE9x99wZuDfS5ZnZhakuk5Q7fG2DAvcm9Xhk3OmkduNw2hGOWDLsMD24W1YtNG1zbIl4rkFwfs+k1uGBR63T2p1y77pRS0hl6CpGWV5grDAj5fnwdK35imkkSXtLm/m6oxyUIaAQL00arf8CYw8goySbsahdZZCHmgELX8AI5ugiRnlkBQhgUbQ0gMsnyBTcyhoohVXk4OLs0sRFrgaQWhGWZ4oLNA+gzFQ84miuy+2uKnPeS1mT5vnl56zVHEDi6QbZUczygGpYgcWSXeZffaVxThV9MAi6U55AyctcMLogQr4WHgiQa44z72yuJoxILAf5j++48tU/Fh4GkH20ivCoeWnDAjsL1YFgiQP9UrbDcKc+xQUpJ6Ug+dBgsfCEwkKnrTAKYMDq+5BfmGO00SaIp3/sfC5kxY48YzAw6Zv/vYdxdyPhcfvOX7mwEDdK1wnSdyuNNvMSQtJ6sBAW2BmvbYk0dz8/EkLQerQQDtELXttSWRB8S4tRqmDAxf1oPB2QZqlkxa4hfBAXIMEd43ijcHLJi1ETYQG4lEMT7vGO4lbNmkhayNqoEJNMMZLN51k6aSFpI3IgZoWnAVEEmRqzgoFJU5nSvKp9CxPOdVS9MAc6exZz+mMKtmqx1UKssU54ZF13lZQ4PGfrO1ObZzoyuJqW2GB+r1Avag/ip1JR5y0ELQVHNiqc6B9yYnDdBfvV5sKDdR35JetgJn5tcxpc/zbPtMtzgkcDC262TFXkB7bs/Qcv8nQwF3T/NhO3wuL2+7lRpEnLURthgX2V6LD0dUWqEGN+VO5oF911ykwiiWYtMBtRg9Mku7i0qLyGpS1XRet5y1S3fa52XTcwATpcl5aXG07amCCdPa+DwVNBucvzqe2YwcmSJdgRlnedvTAzjywMDzvsnR9kBuz8l1ajHYhemBnBKlpIW+dx4x0dvAq0XP8fYgb2GlBRs2S1R1nfkoZSibosFGCLuZfg6aeG+9P4B7Eo+oedP5W8E8laOgjT50t18Hp8k1aQFIN872jh7cbP+1zM93oyqLA6OXvS9zA5elKXlmMqFRQsSuLazsTOXB5upJXFld2Jnbg8nQlryzGOxM9cE66s1pc9MpiRBWCznpM2SuLETUIsrXGVp4qao+lLkH5ZpTFVCXInDVTkE3n1WI3nVzL6GUpKch5OE3n1DN6WQoKavwPFSk5pxJBTT3H1AVVCGpqKjoXFK1BrvLEzx+N8oL8x+AqpIZDrGoKC6q46xjKCqp38HKUrUH1+ynbg+o/wAoKWoEbRUFBK6GQoOitxv8igd+YguKGR4KCorVKQbEiKSh74KzwSFBQtFYpKFbk5xK0IigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgv6DTQ1WAwy/qob0WvaLYBKK86u0/z7KMHvkFHb7Kdu7jRT3VOPx2Xnvz+5hAkPe47ZPsB4E4o09+QcK36bb62Wr9itlbvzpkAlFe/Szp/vEdZzwjv6C9aNfa5ll9Y/e9UKAsb99zYMZz8gvafWtkLwLTgtSBc7t36H8V5d09vksyemQX9PEyPA+8ExhS30EXi9slQwWK8g7PkkoyehQa5iX/A8MESfK2tkbXL8g8fn+TwEMM59XPItd+iGkkY72sSHfngm7kNT+8U3uR1vsnPsQkg7Jn8kZe+6716od5tWviIi05rTOj2O28h439p9pPFIf3NYreZ2l6wx5eGJjA23nNrxfp17FWfamxMigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAmgXt3ZI6tYR32a8vzqViQaffptArn3byFQcRqVqQWathlo0dtyX6UCWChgVfrse0arnqYWN/hcr+DMx/793h658bdeC5D6mpRNCw7Mt6aJtX9cvTtgcdt6fVYL21VxXgPqSmEkFd+/jXd11i9BK59uHNCvJ/J0evE+tVug+pd6wWQd3OPoeiK07/93VBaiWiXS8vX0k3m2oEucNFf/XeztVD7KtZ5Ow+pN6vWgQdt7+ZBaqjHuQXp/sVtP/y71YfSaMa5A/zuvTsvA+pd6wSQYMMu8b5chQzJ4rqga/DRv161+vpQ2oqETR0BVdr9HmQ/0uT6mnCobccNr9v1GJf9yE1lQiS4p7FkDzsEQUKAlAQYGWC8kNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8DYED7hOMPPvIAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X[,<span class="dv">2</span>],Y[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;y of Cpp&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y of R&quot;</span>)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="at">gibbsC=</span><span class="fu">gibbsC</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">10000</span>,<span class="dv">10</span>,<span class="fl">0.1</span>),<span class="at">gibbsR=</span><span class="fu">gibbsR</span>(<span class="dv">20</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">10000</span>,<span class="dv">10</span>,<span class="fl">0.1</span>))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##    expr       min        lq      mean    median        uq       max neval
##  gibbsC  3.622793  3.671454  3.803125  3.697195  3.770716  5.693716   100
##  gibbsR 40.939247 49.046805 49.789833 49.872107 52.262852 70.824991   100</code></pre>
</div>
<div id="section-30" class="section level3">
<h3>4</h3>
<p>通过上述实验我们可以看出利用两种语言进行Gibbs抽样生成的链的结果很相近，都可以得到我们想要的马尔科夫链，但是通过比较两种语言的运行时间可以看出利用Cpp语言写的函数运行更快。</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
